import{version as t,revision as e}from"../core/core.js";import{string as r}from"../core/string.js";import{now as o}from"../core/time.js";import"../core/debug.js";import{math as n}from"../core/math/math.js";import{Color as s}from"../core/math/color.js";import{Mat4 as i}from"../core/math/mat4.js";import{Vec2 as a}from"../core/math/vec2.js";import{Vec3 as p}from"../core/math/vec3.js";import{Vec4 as c}from"../core/math/vec4.js";import{BoundingBox as l}from"../core/shape/bounding-box.js";import{BoundingSphere as f}from"../core/shape/bounding-sphere.js";import{Frustum as m}from"../core/shape/frustum.js";import{Plane as u}from"../core/shape/plane.js";import{TYPE_INT8 as d,TYPE_UINT8 as h,TYPE_INT16 as y,TYPE_UINT16 as g,TYPE_INT32 as E,TYPE_UINT32 as _,TYPE_FLOAT32 as T,PIXELFORMAT_LA8 as b,PIXELFORMAT_RGB565 as S,PIXELFORMAT_RGBA5551 as I,PIXELFORMAT_RGBA4 as j,PIXELFORMAT_RGB8 as C,PIXELFORMAT_RGBA8 as L,BLENDMODE_CONSTANT as A,BLENDMODE_ONE_MINUS_CONSTANT as O,ADDRESS_CLAMP_TO_EDGE as M,ADDRESS_MIRRORED_REPEAT as P,ADDRESS_REPEAT as R,BLENDMODE_ZERO as N,BLENDMODE_ONE as B,BLENDMODE_SRC_COLOR as D,BLENDMODE_ONE_MINUS_SRC_COLOR as F,BLENDMODE_DST_COLOR as w,BLENDMODE_ONE_MINUS_DST_COLOR as v,BLENDMODE_SRC_ALPHA as x,BLENDMODE_SRC_ALPHA_SATURATE as k,BLENDMODE_ONE_MINUS_SRC_ALPHA as V,BLENDMODE_DST_ALPHA as U,BLENDMODE_ONE_MINUS_DST_ALPHA as G,BUFFER_STATIC as X,BUFFER_DYNAMIC as W,BUFFER_STREAM as H,CULLFACE_NONE as K,CULLFACE_BACK as Y,CULLFACE_FRONT as q,CULLFACE_FRONTANDBACK as z,FILTER_NEAREST as Q,FILTER_LINEAR as J,FILTER_NEAREST_MIPMAP_NEAREST as Z,FILTER_NEAREST_MIPMAP_LINEAR as $,FILTER_LINEAR_MIPMAP_NEAREST as tt,FILTER_LINEAR_MIPMAP_LINEAR as et,INDEXFORMAT_UINT8 as rt,INDEXFORMAT_UINT16 as ot,INDEXFORMAT_UINT32 as nt,PRIMITIVE_POINTS as st,PRIMITIVE_LINES as it,PRIMITIVE_LINELOOP as at,PRIMITIVE_LINESTRIP as pt,PRIMITIVE_TRIANGLES as ct,PRIMITIVE_TRISTRIP as lt,PRIMITIVE_TRIFAN as ft,SEMANTIC_POSITION as mt,SEMANTIC_NORMAL as ut,SEMANTIC_COLOR as dt,SEMANTIC_TEXCOORD as ht,SEMANTIC_TEXCOORD0 as yt,SEMANTIC_TEXCOORD1 as gt,SEMANTIC_ATTR0 as Et,SEMANTIC_ATTR1 as _t,SEMANTIC_ATTR2 as Tt,SEMANTIC_ATTR3 as bt,TEXTURELOCK_READ as St,TEXTURELOCK_WRITE as It,TEXTURETYPE_RGBM as jt,TEXTURETYPE_DEFAULT as Ct,TEXTURETYPE_SWIZZLEGGGR as Lt}from"../platform/graphics/constants.js";import{begin as At,end as Ot,fogCode as Mt,gammaCode as Pt,skinCode as Rt,tonemapCode as Nt}from"../scene/shader-lib/programs/common.js";import{drawQuadWithShader as Bt}from"../scene/graphics/quad-render-utils.js";import{shaderChunks as Dt}from"../scene/shader-lib/chunks/chunks.js";import{GraphicsDevice as Ft}from"../platform/graphics/graphics-device.js";import{IndexBuffer as wt}from"../platform/graphics/index-buffer.js";import{PostEffect as vt}from"../scene/graphics/post-effect.js";import{PostEffectQueue as xt}from"../framework/components/camera/post-effect-queue.js";import{ProgramLibrary as kt}from"../scene/shader-lib/program-library.js";import{getProgramLibrary as Vt,setProgramLibrary as Ut}from"../scene/shader-lib/get-program-library.js";import{RenderTarget as Gt}from"../platform/graphics/render-target.js";import{ScopeId as Xt}from"../platform/graphics/scope-id.js";import{Shader as Wt}from"../platform/graphics/shader.js";import{WebglShaderInput as Ht}from"../platform/graphics/webgl/webgl-shader-input.js";import{Texture as Kt}from"../platform/graphics/texture.js";import{VertexBuffer as Yt}from"../platform/graphics/vertex-buffer.js";import{VertexFormat as qt}from"../platform/graphics/vertex-format.js";import{VertexIterator as zt}from"../platform/graphics/vertex-iterator.js";import{ShaderUtils as Qt}from"../platform/graphics/shader-utils.js";import{GraphicsDeviceAccess as Jt}from"../platform/graphics/graphics-device-access.js";import{BlendState as Zt}from"../platform/graphics/blend-state.js";import{DepthState as $t}from"../platform/graphics/depth-state.js";import{LAYERID_WORLD as te,LAYERID_IMMEDIATE as ee,LINEBATCH_OVERLAY as re,PROJECTION_ORTHOGRAPHIC as oe,PROJECTION_PERSPECTIVE as ne}from"../scene/constants.js";import{calculateTangents as se,createMesh as ie,createTorus as ae,createCylinder as pe,createCapsule as ce,createCone as le,createSphere as fe,createPlane as me,createBox as ue}from"../scene/procedural.js";import{partitionSkin as de}from"../scene/skin-partition.js";import{BasicMaterial as he}from"../scene/materials/basic-material.js";import{ForwardRenderer as ye}from"../scene/renderer/forward-renderer.js";import{GraphNode as ge}from"../scene/graph-node.js";import{Material as Ee}from"../scene/materials/material.js";import{Mesh as _e}from"../scene/mesh.js";import{Morph as Te}from"../scene/morph.js";import{Command as be,MeshInstance as Se}from"../scene/mesh-instance.js";import{Model as Ie}from"../scene/model.js";import{ParticleEmitter as je}from"../scene/particle-system/particle-emitter.js";import{Picker as Ce}from"../framework/graphics/picker.js";import{Scene as Le}from"../scene/scene.js";import{Skin as Ae}from"../scene/skin.js";import{SkinInstance as Oe}from"../scene/skin-instance.js";import{StandardMaterial as Me}from"../scene/materials/standard-material.js";import{Batch as Pe}from"../scene/batching/batch.js";import{getDefaultMaterial as Re}from"../scene/materials/default-material.js";import{StandardMaterialOptions as Ne}from"../scene/materials/standard-material-options.js";import{LitOptions as Be}from"../scene/materials/lit-options.js";import{Layer as De}from"../scene/layer.js";import{Animation as Fe,Key as we,Node as ve}from"../scene/animation/animation.js";import{Skeleton as xe}from"../scene/animation/skeleton.js";import{Channel as ke}from"../platform/audio/channel.js";import{Channel3d as Ve}from"../platform/audio/channel3d.js";import{Listener as Ue}from"../platform/sound/listener.js";import{Sound as Ge}from"../platform/sound/sound.js";import{SoundManager as Xe}from"../platform/sound/manager.js";import{AssetRegistry as We}from"../framework/asset/asset-registry.js";import{XrInputSource as He}from"../framework/xr/xr-input-source.js";import{Controller as Ke}from"../platform/input/controller.js";import{ElementInput as Ye}from"../framework/input/element-input.js";import{GamePads as qe}from"../platform/input/game-pads.js";import{Keyboard as ze}from"../platform/input/keyboard.js";import{KeyboardEvent as Qe}from"../platform/input/keyboard-event.js";import{Mouse as Je}from"../platform/input/mouse.js";import{MouseEvent as Ze}from"../platform/input/mouse-event.js";import{TouchDevice as $e}from"../platform/input/touch-device.js";import{getTouchTargetCoords as tr,Touch as er,TouchEvent as rr}from"../platform/input/touch-event.js";import{AppBase as or}from"../framework/app-base.js";import{getApplication as nr}from"../framework/globals.js";import{CameraComponent as sr}from"../framework/components/camera/component.js";import{LightComponent as ir}from"../framework/components/light/component.js";import{ModelComponent as ar}from"../framework/components/model/component.js";import{RenderComponent as pr}from"../framework/components/render/component.js";import{BODYTYPE_STATIC as cr,BODYTYPE_DYNAMIC as lr,BODYTYPE_KINEMATIC as fr,BODYFLAG_STATIC_OBJECT as mr,BODYFLAG_KINEMATIC_OBJECT as ur,BODYFLAG_NORESPONSE_OBJECT as dr,BODYSTATE_ACTIVE_TAG as hr,BODYSTATE_ISLAND_SLEEPING as yr,BODYSTATE_WANTS_DEACTIVATION as gr,BODYSTATE_DISABLE_DEACTIVATION as Er,BODYSTATE_DISABLE_SIMULATION as _r}from"../framework/components/rigid-body/constants.js";import{RigidBodyComponent as Tr}from"../framework/components/rigid-body/component.js";import{RigidBodyComponentSystem as br}from"../framework/components/rigid-body/system.js";import{basisInitialize as Sr}from"../framework/handlers/basis.js";const Ir={write:function(t){console.log(t)},open:function(){Ir.write("Powered by PlayCanvas "+t+" "+e)},info:function(t){console.info("INFO:    "+t)},debug:function(t){console.debug("DEBUG:   "+t)},error:function(t){console.error("ERROR:   "+t)},warning:function(t){console.warn("WARNING: "+t)},alert:function(t){Ir.write("ALERT:   "+t),alert(t)},assert:function(t,e){!1===t&&Ir.write("ASSERT:  "+e)}};r.endsWith=function(t,e){return t.endsWith(e)},r.startsWith=function(t,e){return t.startsWith(e)};const jr={now:o,Timer:class{constructor(){this._isRunning=!1,this._a=0,this._b=0}start(){this._isRunning=!0,this._a=o()}stop(){this._isRunning=!1,this._b=o()}getMilliseconds(){return this._b-this._a}}};function Cr(t,e){const r=function(){},o=function(r,o,n,s,i,a,p,c){e.call(this,r,o,n,s,i,a,p,c),t.call(this,r,o,n,s,i,a,p,c)};return o._super=e.prototype,r.prototype=e.prototype,o.prototype=new r,o}function Lr(t){return Array.prototype.slice.call(t)}function Ar(t){const e=document.createElement("style");return e.type="text/css",e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t)),e}Object.defineProperty(s.prototype,"data",{get:function(){return this._data||(this._data=new Float32Array(4)),this._data[0]=this.r,this._data[1]=this.g,this._data[2]=this.b,this._data[3]=this.a,this._data}}),Object.defineProperty(s.prototype,"data3",{get:function(){return this._data3||(this._data3=new Float32Array(3)),this._data3[0]=this.r,this._data3[1]=this.g,this._data3[2]=this.b,this._data3}}),n.INV_LOG2=Math.LOG2E,n.intToBytes=n.intToBytes32,n.bytesToInt=n.bytesToInt32,Object.defineProperty(a.prototype,"data",{get:function(){return this._data||(this._data=new Float32Array(2)),this._data[0]=this.x,this._data[1]=this.y,this._data}}),a.prototype.scale=a.prototype.mulScalar,Object.defineProperty(p.prototype,"data",{get:function(){return this._data||(this._data=new Float32Array(3)),this._data[0]=this.x,this._data[1]=this.y,this._data[2]=this.z,this._data}}),p.prototype.scale=p.prototype.mulScalar,Object.defineProperty(c.prototype,"data",{get:function(){return this._data||(this._data=new Float32Array(4)),this._data[0]=this.x,this._data[1]=this.y,this._data[2]=this.z,this._data[3]=this.w,this._data}}),c.prototype.scale=c.prototype.mulScalar;const Or={Aabb:l,Sphere:f,Plane:u};f.prototype.intersectRay=f.prototype.intersectsRay,m.prototype.update=function(t,e){const r=new i;r.mul2(t,e),this.setFromMat4(r)};const Mr=d,Pr=h,Rr=y,Nr=g,Br=E,Dr=_,Fr=T,wr=b,vr=S,xr=I,kr=j,Vr=C,Ur=L,Gr=A,Xr=O,Wr=A,Hr=O;function Kr(t){this.name="UnsupportedBrowserError",this.message=t||""}function Yr(t){this.name="ContextCreationError",this.message=t||""}Kr.prototype=Error.prototype,Yr.prototype=Error.prototype;const qr={begin:At,dummyFragmentCode:Qt.dummyFragmentCode,end:Ot,fogCode:Mt,gammaCode:Pt,precisionCode:Qt.precisionCode,skinCode:Rt,tonemapCode:Nt,versionCode:Qt.versionCode},zr={ADDRESS_CLAMP_TO_EDGE:M,ADDRESS_MIRRORED_REPEAT:P,ADDRESS_REPEAT:R,BLENDMODE_ZERO:N,BLENDMODE_ONE:B,BLENDMODE_SRC_COLOR:D,BLENDMODE_ONE_MINUS_SRC_COLOR:F,BLENDMODE_DST_COLOR:w,BLENDMODE_ONE_MINUS_DST_COLOR:v,BLENDMODE_SRC_ALPHA:x,BLENDMODE_SRC_ALPHA_SATURATE:k,BLENDMODE_ONE_MINUS_SRC_ALPHA:V,BLENDMODE_DST_ALPHA:U,BLENDMODE_ONE_MINUS_DST_ALPHA:G,BUFFER_STATIC:X,BUFFER_DYNAMIC:W,BUFFER_STREAM:H,CULLFACE_NONE:K,CULLFACE_BACK:Y,CULLFACE_FRONT:q,CULLFACE_FRONTANDBACK:z,ELEMENTTYPE_INT8:d,ELEMENTTYPE_UINT8:h,ELEMENTTYPE_INT16:y,ELEMENTTYPE_UINT16:g,ELEMENTTYPE_INT32:E,ELEMENTTYPE_UINT32:_,ELEMENTTYPE_FLOAT32:T,FILTER_NEAREST:Q,FILTER_LINEAR:J,FILTER_NEAREST_MIPMAP_NEAREST:Z,FILTER_NEAREST_MIPMAP_LINEAR:$,FILTER_LINEAR_MIPMAP_NEAREST:tt,FILTER_LINEAR_MIPMAP_LINEAR:et,INDEXFORMAT_UINT8:rt,INDEXFORMAT_UINT16:ot,INDEXFORMAT_UINT32:nt,PIXELFORMAT_RGB565:S,PIXELFORMAT_RGB8:C,PIXELFORMAT_RGBA8:L,PRIMITIVE_POINTS:st,PRIMITIVE_LINES:it,PRIMITIVE_LINELOOP:at,PRIMITIVE_LINESTRIP:pt,PRIMITIVE_TRIANGLES:ct,PRIMITIVE_TRISTRIP:lt,PRIMITIVE_TRIFAN:ft,SEMANTIC_POSITION:mt,SEMANTIC_NORMAL:ut,SEMANTIC_COLOR:dt,SEMANTIC_TEXCOORD:ht,SEMANTIC_TEXCOORD0:yt,SEMANTIC_TEXCOORD1:gt,SEMANTIC_ATTR0:Et,SEMANTIC_ATTR1:_t,SEMANTIC_ATTR2:Tt,SEMANTIC_ATTR3:bt,TEXTURELOCK_READ:St,TEXTURELOCK_WRITE:It,drawQuadWithShader:Bt,programlib:qr,shaderChunks:Dt,ContextCreationError:Yr,Device:Ft,IndexBuffer:wt,ProgramLibrary:kt,RenderTarget:Gt,ScopeId:Xt,Shader:Wt,ShaderInput:Ht,Texture:Kt,UnsupportedBrowserError:Kr,VertexBuffer:Yt,VertexFormat:qt,VertexIterator:zt},Qr=new c;function Jr(t,e,r,o,n){let s;if(n){const r=e?e.width:t.width,o=e?e.height:t.height;s=Qr.set(n.x*r,n.y*o,n.z*r,n.w*o)}Bt(t,e,o,s)}const Zr={createFullscreenQuad:t=>t.quadVertexBuffer,drawFullscreenQuad:Jr,PostEffect:vt,PostEffectQueue:xt};Object.defineProperty(Dt,"transformSkinnedVS",{get:function(){return"#define SKIN\n"+Dt.transformVS}});Object.keys({"ambientPrefilteredCube.frag":"ambientEnv.frag","ambientPrefilteredCubeLod.frag":"ambientEnv.frag","dpAtlasQuad.frag":null,"genParaboloid.frag":null,"prefilterCubemap.frag":null,"reflectionDpAtlas.frag":"reflectionEnv.frag","reflectionPrefilteredCube.frag":"reflectionEnv.frag","reflectionPrefilteredCubeLod.frag":"reflectionEnv.frag"}).forEach((t=>{Object.defineProperty(Dt,t,{get:function(){return null},set:function(){}})})),Object.defineProperties(Gt.prototype,{_glFrameBuffer:{get:function(){return this.impl._glFrameBuffer},set:function(t){}}}),Object.defineProperty(qt,"defaultInstancingFormat",{get:function(){return qt.getDefaultInstancingFormat(Jt.get())}}),Object.defineProperties(Kt.prototype,{rgbm:{get:function(){return this.type===jt},set:function(t){this.type=t?jt:Ct}},swizzleGGGR:{get:function(){return this.type===Lt},set:function(t){this.type=t?Lt:Ct}},_glTexture:{get:function(){return this.impl._glTexture}},autoMipmap:{get:function(){return this._mipmaps},set:function(t){this._mipmaps=t}}}),Ft.prototype.getProgramLibrary=function(){return Vt(this)},Ft.prototype.setProgramLibrary=function(t){Ut(this,t)},Ft.prototype.removeShaderFromCache=function(t){Vt(this).removeFromCache(t)};const $r=new Zt,to=new $t;Ft.prototype.setBlendFunction=function(t,e){const r=this.blendState;$r.copy(r),$r.setColorBlend(r.colorOp,t,e),$r.setAlphaBlend(r.alphaOp,t,e),this.setBlendState($r)},Ft.prototype.setBlendFunctionSeparate=function(t,e,r,o){const n=this.blendState;$r.copy(n),$r.setColorBlend(n.colorOp,t,e),$r.setAlphaBlend(n.alphaOp,r,o),this.setBlendState($r)},Ft.prototype.setBlendEquation=function(t){const e=this.blendState;$r.copy(e),$r.setColorBlend(t,e.colorSrcFactor,e.colorDstFactor),$r.setAlphaBlend(t,e.alphaSrcFactor,e.alphaDstFactor),this.setBlendState($r)},Ft.prototype.setBlendEquationSeparate=function(t,e){const r=this.blendState;$r.copy(r),$r.setColorBlend(t,r.colorSrcFactor,r.colorDstFactor),$r.setAlphaBlend(e,r.alphaSrcFactor,r.alphaDstFactor),this.setBlendState($r)},Ft.prototype.setColorWrite=function(t,e,r,o){const n=this.blendState;$r.copy(n),$r.setColorWrite(t,e,r,o),this.setBlendState($r)},Ft.prototype.getBlending=function(){return this.blendState.blend},Ft.prototype.setBlending=function(t){$r.copy(this.blendState),$r.blend=t,this.setBlendState($r)},Ft.prototype.setDepthWrite=function(t){to.copy(this.depthState),to.write=t,this.setDepthState(to)},Ft.prototype.setDepthFunc=function(t){to.copy(this.depthState),to.func=t,this.setDepthState(to)},Ft.prototype.setDepthTest=function(t){to.copy(this.depthState),to.test=t,this.setDepthState(to)},Ft.prototype.getCullMode=function(){return this.cullMode};const eo=Me,ro={partitionSkin:de,procedural:{calculateTangents:se,createMesh:ie,createTorus:ae,createCylinder:pe,createCapsule:ce,createCone:le,createSphere:fe,createPlane:me,createBox:ue},BasicMaterial:he,Command:be,ForwardRenderer:ye,GraphNode:ge,Material:Ee,Mesh:_e,MeshInstance:Se,Model:Ie,ParticleEmitter:je,PhongMaterial:Me,Picker:Ce,Projection:{ORTHOGRAPHIC:oe,PERSPECTIVE:ne},Scene:Le,Skin:Ae,SkinInstance:Oe};function oo(t,e){Object.defineProperty(Me.prototype,e,{get:function(){return this[t]},set:function(e){this[t]=e}})}function no(t,e){"chunks"!==t&&"_pass"!==t&&"_isForwardPass"!==t&&Object.defineProperty(Ne.prototype,t,{get:function(){return this.litOptions[e||t]},set:function(r){this.litOptions[e||t]=r}})}Object.defineProperty(Le.prototype,"defaultMaterial",{get:function(){return Re(nr().graphicsDevice)}}),["128","64","32","16","8","4"].forEach(((t,e)=>{Object.defineProperty(Le.prototype,`skyboxPrefiltered${t}`,{get:function(){return this._prefilteredCubemaps[e]},set:function(t){this._prefilteredCubemaps[e]=t,this.updateShaders=!0}})})),Object.defineProperty(Le.prototype,"models",{get:function(){return this._models||(this._models=[]),this._models}}),Object.defineProperty(De.prototype,"renderTarget",{set:function(t){this._renderTarget=t,this._dirtyCameras=!0},get:function(){return this._renderTarget}}),Le.prototype._updateSkybox=function(t){this._updateSky(t)},Le.prototype.addModel=function(t){if(this.containsModel(t))return;const e=this.layers.getLayerById(te);e&&(e.addMeshInstances(t.meshInstances),this.models.push(t))},Le.prototype.addShadowCaster=function(t){const e=this.layers.getLayerById(te);e&&e.addShadowCasters(t.meshInstances)},Le.prototype.removeModel=function(t){const e=this.models.indexOf(t);if(-1!==e){const r=this.layers.getLayerById(te);if(!r)return;r.removeMeshInstances(t.meshInstances),this.models.splice(e,1)}},Le.prototype.removeShadowCasters=function(t){const e=this.layers.getLayerById(te);e&&e.removeShadowCasters(t.meshInstances)},Le.prototype.containsModel=function(t){return this.models.indexOf(t)>=0},Le.prototype.getModels=function(t){return this.models},Object.defineProperty(Pe.prototype,"model",{get:function(){return null}}),ye.prototype.renderComposition=function(t){nr().renderComposition(t)},ye.prototype.updateShader=function(t,e,r,o,n){const s=t.material._scene||nr().scene;return t.updatePassShader(s,o,r,n)},Se.prototype.syncAabb=function(){},Te.prototype.getTarget=function(t){return this.targets[t]},ge.prototype._dirtify=function(t){t?this._dirtifyLocal():this._dirtifyWorld()},ge.prototype.addLabel=function(t){this._labels[t]=!0},ge.prototype.getLabels=function(){return Object.keys(this._labels)},ge.prototype.hasLabel=function(t){return!!this._labels[t]},ge.prototype.removeLabel=function(t){delete this._labels[t]},ge.prototype.findByLabel=function(t,e=[]){this.hasLabel(t)&&e.push(this);for(let r=0;r<this._children.length;++r)e=this._children[r].findByLabel(t,e);return e},ge.prototype.getChildren=function(){return this.children},ge.prototype.getName=function(){return this.name},ge.prototype.getPath=function(){return this.path},ge.prototype.getRoot=function(){return this.root},ge.prototype.getParent=function(){return this.parent},ge.prototype.setName=function(t){this.name=t},Ee.prototype.getName=function(){return this.name},Ee.prototype.setName=function(t){this.name=t},Ee.prototype.getShader=function(){return this.shader},Ee.prototype.setShader=function(t){this.shader=t},Object.defineProperty(Ee.prototype,"blend",{set:function(t){this.blendState.blend=t},get:function(){return this.blendState.blend}}),Object.defineProperty(Ee.prototype,"blendSrc",{set:function(t){const e=this.blendState;$r.copy(e),$r.setColorBlend(e.colorOp,t,e.colorDstFactor),$r.setAlphaBlend(e.alphaOp,t,e.alphaDstFactor),this.blendState=$r},get:function(){return this.blendState.colorSrcFactor}}),Object.defineProperty(Ee.prototype,"blendDst",{set:function(t){const e=this.blendState;$r.copy(e),$r.setColorBlend(e.colorOp,e.colorSrcFactor,t),$r.setAlphaBlend(e.alphaOp,e.alphaSrcFactor,t),this.blendState=$r},get:function(){return this.blendState.colorDstFactor}}),Object.defineProperty(Me.prototype,"shininess",{get:function(){return 100*this.gloss},set:function(t){this.gloss=.01*t}}),oo("diffuseTint","diffuseMapTint"),oo("specularTint","specularMapTint"),oo("emissiveTint","emissiveMapTint"),oo("aoVertexColor","aoMapVertexColor"),oo("diffuseVertexColor","diffuseMapVertexColor"),oo("specularVertexColor","specularMapVertexColor"),oo("emissiveVertexColor","emissiveMapVertexColor"),oo("metalnessVertexColor","metalnessMapVertexColor"),oo("glossVertexColor","glossMapVertexColor"),oo("opacityVertexColor","opacityMapVertexColor"),oo("lightVertexColor","lightMapVertexColor"),oo("sheenGloss","sheenGlossiess"),oo("clearCoatGloss","clearCostGlossiness"),no("refraction","useRefraction");const so=new Be,io=Object.getOwnPropertyNames(so);for(const t in io)no(io[t]);const ao={Animation:Fe,Key:we,Node:ve,Skeleton:xe};Fe.prototype.getDuration=function(){return this.duration},Fe.prototype.getName=function(){return this.name},Fe.prototype.getNodes=function(){return this.nodes},Fe.prototype.setDuration=function(t){this.duration=t},Fe.prototype.setName=function(t){this.name=t},xe.prototype.getAnimation=function(){return this.animation},xe.prototype.getCurrentTime=function(){return this.currentTime},xe.prototype.getLooping=function(){return this.looping},xe.prototype.getNumNodes=function(){return this.numNodes},xe.prototype.setAnimation=function(t){this.animation=t},xe.prototype.setCurrentTime=function(t){this.currentTime=t},xe.prototype.setLooping=function(t){this.looping=t};const po={AudioManager:Xe,Channel:ke,Channel3d:Ve,Listener:Ue,Sound:Ge};Xe.prototype.getListener=function(){return this.listener},Xe.prototype.getVolume=function(){return this.volume},Xe.prototype.setVolume=function(t){this.volume=t};const co={ASSET_ANIMATION:"animation",ASSET_AUDIO:"audio",ASSET_IMAGE:"image",ASSET_JSON:"json",ASSET_MODEL:"model",ASSET_MATERIAL:"material",ASSET_TEXT:"text",ASSET_TEXTURE:"texture",ASSET_CUBEMAP:"cubemap",ASSET_SCRIPT:"script"};We.prototype.getAssetById=function(t){return this.get(t)},Object.defineProperty(He.prototype,"ray",{get:function(){return this._rayLocal}}),Object.defineProperty(He.prototype,"position",{get:function(){return this._localPosition}}),Object.defineProperty(He.prototype,"rotation",{get:function(){return this._localRotation}});const lo={getTouchTargetCoords:tr,Controller:Ke,GamePads:qe,Keyboard:ze,KeyboardEvent:Qe,Mouse:Je,MouseEvent:Ze,Touch:er,TouchDevice:$e,TouchEvent:rr};Object.defineProperty(Ye.prototype,"wheel",{get:function(){return-2*this.wheelDelta}}),Object.defineProperty(Ze.prototype,"wheel",{get:function(){return-2*this.wheelDelta}});const fo=cr,mo=lr,uo=fr,ho=mr,yo=ur,go=dr,Eo=hr,_o=yr,To=gr,bo=Er,So=_r;function Io(t,e,r){Sr({glueUrl:t,wasmUrl:e,fallbackUrl:r,lazyInit:!0})}function jo(t){}or.prototype.isFullscreen=function(){return!!document.fullscreenElement},or.prototype.enableFullscreen=function(t,e,r){t=t||this.graphicsDevice.canvas;const o=function t(){e(),document.removeEventListener("fullscreenchange",t)},n=function t(){r(),document.removeEventListener("fullscreenerror",t)};e&&document.addEventListener("fullscreenchange",o,!1),r&&document.addEventListener("fullscreenerror",n,!1),t.requestFullscreen?t.requestFullscreen(Element.ALLOW_KEYBOARD_INPUT):r()},or.prototype.disableFullscreen=function(t){const e=function e(){t(),document.removeEventListener("fullscreenchange",e)};t&&document.addEventListener("fullscreenchange",e,!1),document.exitFullscreen()},or.prototype.getSceneUrl=function(t){const e=this.scenes.find(t);return e?e.url:null},or.prototype.loadScene=function(t,e){this.scenes.loadScene(t,e)},or.prototype.loadSceneHierarchy=function(t,e){this.scenes.loadSceneHierarchy(t,e)},or.prototype.loadSceneSettings=function(t,e){this.scenes.loadSceneSettings(t,e)},or.prototype.renderMeshInstance=function(t,e){const r=null!=e&&e.layer?e.layer:this.scene.defaultDrawLayer;this.scene.immediate.drawMesh(null,null,null,t,r)},or.prototype.renderMesh=function(t,e,r,o){const n=null!=o&&o.layer?o.layer:this.scene.defaultDrawLayer;this.scene.immediate.drawMesh(e,r,t,null,n)},or.prototype._addLines=function(t,e,r){const o=r&&r.layer?r.layer:this.scene.layers.getLayerById(ee),n=!r||void 0===r.depthTest||r.depthTest;this.scene.immediate.getBatch(o,n).addLines(t,e)},or.prototype.renderLine=function(t,e,r){let o,n=r;const i=arguments[3],a=arguments[4];i instanceof s?(n=i,o="number"==typeof a?a===re?{layer:this.scene.layers.getLayerById(ee),depthTest:!1}:{layer:this.scene.layers.getLayerById(ee),depthTest:!0}:a):"number"==typeof i?(n=r,o=i===re?{layer:this.scene.layers.getLayerById(ee),depthTest:!1}:{layer:this.scene.layers.getLayerById(ee),depthTest:!0}):i&&(o=i),this._addLines([t,e],[r,n],o)},or.prototype.renderLines=function(t,e,r){r?"number"==typeof r&&(r=r===re?{layer:this.scene.layers.getLayerById(ee),depthTest:!1}:{layer:this.scene.layers.getLayerById(ee),depthTest:!0}):r={layer:this.scene.layers.getLayerById(ee),depthTest:!0};!e.length||t.length===e.length?t.length%2==0?this._addLines(t,e,r):console.error("renderLines: array length is not divisible by 2"):console.error("renderLines: position/color arrays have different lengths")},or.prototype.enableVr=function(){},Object.defineProperty(sr.prototype,"node",{get:function(){return this.entity}}),Object.defineProperty(ir.prototype,"enable",{get:function(){return this.enabled},set:function(t){this.enabled=t}}),ar.prototype.setVisible=function(t){this.enabled=t},Object.defineProperty(ar.prototype,"aabb",{get:function(){return null},set:function(t){}}),Object.defineProperty(pr.prototype,"aabb",{get:function(){return null},set:function(t){}}),Object.defineProperty(Tr.prototype,"bodyType",{get:function(){return this.type},set:function(t){this.type=t}}),Tr.prototype.syncBodyToEntity=function(){this._updateDynamic()},br.prototype.setGravity=function(){1===arguments.length?this.gravity.copy(arguments[0]):this.gravity.set(arguments[0],arguments[1],arguments[2])};export{Wr as BLENDMODE_CONSTANT_ALPHA,Gr as BLENDMODE_CONSTANT_COLOR,Hr as BLENDMODE_ONE_MINUS_CONSTANT_ALPHA,Xr as BLENDMODE_ONE_MINUS_CONSTANT_COLOR,Yr as ContextCreationError,Fr as ELEMENTTYPE_FLOAT32,Rr as ELEMENTTYPE_INT16,Br as ELEMENTTYPE_INT32,Mr as ELEMENTTYPE_INT8,Nr as ELEMENTTYPE_UINT16,Dr as ELEMENTTYPE_UINT32,Pr as ELEMENTTYPE_UINT8,wr as PIXELFORMAT_L8_A8,kr as PIXELFORMAT_R4_G4_B4_A4,xr as PIXELFORMAT_R5_G5_B5_A1,vr as PIXELFORMAT_R5_G6_B5,Vr as PIXELFORMAT_R8_G8_B8,Ur as PIXELFORMAT_R8_G8_B8_A8,eo as PhongMaterial,Eo as RIGIDBODY_ACTIVE_TAG,yo as RIGIDBODY_CF_KINEMATIC_OBJECT,go as RIGIDBODY_CF_NORESPONSE_OBJECT,ho as RIGIDBODY_CF_STATIC_OBJECT,bo as RIGIDBODY_DISABLE_DEACTIVATION,So as RIGIDBODY_DISABLE_SIMULATION,_o as RIGIDBODY_ISLAND_SLEEPING,mo as RIGIDBODY_TYPE_DYNAMIC,uo as RIGIDBODY_TYPE_KINEMATIC,fo as RIGIDBODY_TYPE_STATIC,To as RIGIDBODY_WANTS_DEACTIVATION,Kr as UnsupportedBrowserError,ao as anim,co as asset,po as audio,Io as basisSetDownloadConfig,Ar as createStyle,Jr as drawFullscreenQuad,zr as gfx,Cr as inherits,lo as input,Ir as log,Lr as makeArray,Zr as posteffect,jo as prefilterCubemap,qr as programlib,ro as scene,Or as shape,jr as time};
