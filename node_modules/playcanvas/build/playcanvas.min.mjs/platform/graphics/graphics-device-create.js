import"../../core/debug.js";import{platform as e}from"../../core/platform.js";import{WebgpuGraphicsDevice as r}from"./webgpu/webgpu-graphics-device.js";import{DEVICETYPE_WEBGL2 as o,DEVICETYPE_WEBGL1 as l,DEVICETYPE_WEBGPU as i}from"./constants.js";import{WebglGraphicsDevice as t}from"./webgl/webgl-graphics-device.js";function n(n,s={}){var p;const a=null!=(p=s.deviceTypes)?p:[];(a.includes(o)||a.push(o),a.includes(l)||a.push(l),e.browser&&navigator.xr)&&(null!=s.xrCompatible||(s.xrCompatible=!0));let c;for(let e=0;e<a.length;e++){var u,g;const l=a[e];if(l===i&&null!=(u=window)&&null!=(g=u.navigator)&&g.gpu)return c=new r(n,s),c.initWebGpu(s.glslangUrl,s.twgslUrl);if(l!==i)return s.preferWebGl2=l===o,c=new t(n,s),Promise.resolve(c)}return Promise.reject(new Error("Failed to allocate graphics device"))}export{n as createGraphicsDevice};
