import { Debug, DebugHelper } from '../../../core/debug.js';
import { SHADERLANGUAGE_WGSL } from '../constants.js';
import { ShaderProcessor } from '../shader-processor.js';
import { WebgpuDebug } from './webgpu-debug.js';

/**
 * A WebGPU implementation of the Shader.
 *
 * @ignore
 */
class WebgpuShader {
  /**
   * @param {import('../shader.js').Shader} shader - The shader.
   */
  constructor(shader) {
    /**
     * Transpiled vertex shader code.
     *
     * @type {Uint32Array | string}
     */
    this._vertexCode = void 0;
    /**
     * Transpiled fragment shader code.
     *
     * @type {Uint32Array | string}
     */
    this._fragmentCode = void 0;
    /**
     * Name of the vertex entry point function.
     */
    this.vertexEntryPoint = 'main';
    /**
     * Name of the fragment entry point function.
     */
    this.fragmentEntryPoint = 'main';
    /** @type {import('../shader.js').Shader} */
    this.shader = shader;
    const definition = shader.definition;
    Debug.assert(definition);
    if (definition.shaderLanguage === SHADERLANGUAGE_WGSL) {
      this._vertexCode = definition.vshader;
      this._fragmentCode = definition.fshader;
      this.vertexEntryPoint = 'vertexMain';
      this.fragmentEntryPoint = 'fragmentMain';
      shader.ready = true;
    } else {
      if (definition.processingOptions) {
        this.process();
      }
    }
  }

  /**
   * Free the WebGPU resources associated with a shader.
   *
   * @param {import('../shader.js').Shader} shader - The shader to free.
   */
  destroy(shader) {
    this._vertexCode = null;
    this._fragmentCode = null;
  }
  createShaderModule(code, shaderType) {
    const device = this.shader.device;
    const wgpu = device.wgpu;
    WebgpuDebug.validate(device);
    const shaderModule = wgpu.createShaderModule({
      code: code
    });
    DebugHelper.setLabel(shaderModule, `${shaderType}:${this.shader.label}`);
    WebgpuDebug.end(device, {
      shaderType,
      source: code,
      shader: this.shader
    });
    return shaderModule;
  }
  getVertexShaderModule() {
    return this.createShaderModule(this._vertexCode, 'Vertex');
  }
  getFragmentShaderModule() {
    return this.createShaderModule(this._fragmentCode, 'Fragment');
  }
  process() {
    const shader = this.shader;

    // process the shader source to allow for uniforms
    const processed = ShaderProcessor.run(shader.device, shader.definition, shader);

    // keep reference to processed shaders in debug mode
    Debug.call(() => {
      this.processed = processed;
    });
    this._vertexCode = this.transpile(processed.vshader, 'vertex', shader.definition.vshader);
    this._fragmentCode = this.transpile(processed.fshader, 'fragment', shader.definition.fshader);
    if (!(this._vertexCode && this._fragmentCode)) {
      shader.failed = true;
    } else {
      shader.ready = true;
    }
    shader.meshUniformBufferFormat = processed.meshUniformBufferFormat;
    shader.meshBindGroupFormat = processed.meshBindGroupFormat;
  }
  transpile(src, shaderType, originalSrc) {
    try {
      const spirv = this.shader.device.glslang.compileGLSL(src, shaderType);
      return this.shader.device.twgsl.convertSpirV2WGSL(spirv);
    } catch (err) {
      console.error(`Failed to transpile webgl ${shaderType} shader [${this.shader.label}] to WebGPU: [${err.message}]`, {
        processed: src,
        original: originalSrc,
        shader: this.shader
      });
    }
  }
  get vertexCode() {
    Debug.assert(this._vertexCode);
    return this._vertexCode;
  }
  get fragmentCode() {
    Debug.assert(this._fragmentCode);
    return this._fragmentCode;
  }

  /**
   * Dispose the shader when the context has been lost.
   */
  loseContext() {}

  /**
   * Restore shader after the context has been obtained.
   *
   * @param {import('../graphics-device.js').GraphicsDevice} device - The graphics device.
   * @param {import('../shader.js').Shader} shader - The shader to restore.
   */
  restoreContext(device, shader) {}
}

export { WebgpuShader };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2ViZ3B1LXNoYWRlci5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vc3JjL3BsYXRmb3JtL2dyYXBoaWNzL3dlYmdwdS93ZWJncHUtc2hhZGVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERlYnVnLCBEZWJ1Z0hlbHBlciB9IGZyb20gJy4uLy4uLy4uL2NvcmUvZGVidWcuanMnO1xuaW1wb3J0IHsgU0hBREVSTEFOR1VBR0VfV0dTTCB9IGZyb20gJy4uL2NvbnN0YW50cy5qcyc7XG5cbmltcG9ydCB7IFNoYWRlclByb2Nlc3NvciB9IGZyb20gJy4uL3NoYWRlci1wcm9jZXNzb3IuanMnO1xuaW1wb3J0IHsgV2ViZ3B1RGVidWcgfSBmcm9tICcuL3dlYmdwdS1kZWJ1Zy5qcyc7XG5cbi8qKlxuICogQSBXZWJHUFUgaW1wbGVtZW50YXRpb24gb2YgdGhlIFNoYWRlci5cbiAqXG4gKiBAaWdub3JlXG4gKi9cbmNsYXNzIFdlYmdwdVNoYWRlciB7XG4gICAgLyoqXG4gICAgICogVHJhbnNwaWxlZCB2ZXJ0ZXggc2hhZGVyIGNvZGUuXG4gICAgICpcbiAgICAgKiBAdHlwZSB7VWludDMyQXJyYXkgfCBzdHJpbmd9XG4gICAgICovXG4gICAgX3ZlcnRleENvZGU7XG5cbiAgICAvKipcbiAgICAgKiBUcmFuc3BpbGVkIGZyYWdtZW50IHNoYWRlciBjb2RlLlxuICAgICAqXG4gICAgICogQHR5cGUge1VpbnQzMkFycmF5IHwgc3RyaW5nfVxuICAgICAqL1xuICAgIF9mcmFnbWVudENvZGU7XG5cbiAgICAvKipcbiAgICAgKiBOYW1lIG9mIHRoZSB2ZXJ0ZXggZW50cnkgcG9pbnQgZnVuY3Rpb24uXG4gICAgICovXG4gICAgdmVydGV4RW50cnlQb2ludCA9ICdtYWluJztcblxuICAgIC8qKlxuICAgICAqIE5hbWUgb2YgdGhlIGZyYWdtZW50IGVudHJ5IHBvaW50IGZ1bmN0aW9uLlxuICAgICAqL1xuICAgIGZyYWdtZW50RW50cnlQb2ludCA9ICdtYWluJztcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7aW1wb3J0KCcuLi9zaGFkZXIuanMnKS5TaGFkZXJ9IHNoYWRlciAtIFRoZSBzaGFkZXIuXG4gICAgICovXG4gICAgY29uc3RydWN0b3Ioc2hhZGVyKSB7XG4gICAgICAgIC8qKiBAdHlwZSB7aW1wb3J0KCcuLi9zaGFkZXIuanMnKS5TaGFkZXJ9ICovXG4gICAgICAgIHRoaXMuc2hhZGVyID0gc2hhZGVyO1xuXG4gICAgICAgIGNvbnN0IGRlZmluaXRpb24gPSBzaGFkZXIuZGVmaW5pdGlvbjtcbiAgICAgICAgRGVidWcuYXNzZXJ0KGRlZmluaXRpb24pO1xuXG4gICAgICAgIGlmIChkZWZpbml0aW9uLnNoYWRlckxhbmd1YWdlID09PSBTSEFERVJMQU5HVUFHRV9XR1NMKSB7XG5cbiAgICAgICAgICAgIHRoaXMuX3ZlcnRleENvZGUgPSBkZWZpbml0aW9uLnZzaGFkZXI7XG4gICAgICAgICAgICB0aGlzLl9mcmFnbWVudENvZGUgPSBkZWZpbml0aW9uLmZzaGFkZXI7XG4gICAgICAgICAgICB0aGlzLnZlcnRleEVudHJ5UG9pbnQgPSAndmVydGV4TWFpbic7XG4gICAgICAgICAgICB0aGlzLmZyYWdtZW50RW50cnlQb2ludCA9ICdmcmFnbWVudE1haW4nO1xuICAgICAgICAgICAgc2hhZGVyLnJlYWR5ID0gdHJ1ZTtcblxuICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICBpZiAoZGVmaW5pdGlvbi5wcm9jZXNzaW5nT3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHRoaXMucHJvY2VzcygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRnJlZSB0aGUgV2ViR1BVIHJlc291cmNlcyBhc3NvY2lhdGVkIHdpdGggYSBzaGFkZXIuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2ltcG9ydCgnLi4vc2hhZGVyLmpzJykuU2hhZGVyfSBzaGFkZXIgLSBUaGUgc2hhZGVyIHRvIGZyZWUuXG4gICAgICovXG4gICAgZGVzdHJveShzaGFkZXIpIHtcbiAgICAgICAgdGhpcy5fdmVydGV4Q29kZSA9IG51bGw7XG4gICAgICAgIHRoaXMuX2ZyYWdtZW50Q29kZSA9IG51bGw7XG4gICAgfVxuXG4gICAgY3JlYXRlU2hhZGVyTW9kdWxlKGNvZGUsIHNoYWRlclR5cGUpIHtcbiAgICAgICAgY29uc3QgZGV2aWNlID0gdGhpcy5zaGFkZXIuZGV2aWNlO1xuICAgICAgICBjb25zdCB3Z3B1ID0gZGV2aWNlLndncHU7XG5cbiAgICAgICAgV2ViZ3B1RGVidWcudmFsaWRhdGUoZGV2aWNlKTtcblxuICAgICAgICBjb25zdCBzaGFkZXJNb2R1bGUgPSB3Z3B1LmNyZWF0ZVNoYWRlck1vZHVsZSh7XG4gICAgICAgICAgICBjb2RlOiBjb2RlXG4gICAgICAgIH0pO1xuICAgICAgICBEZWJ1Z0hlbHBlci5zZXRMYWJlbChzaGFkZXJNb2R1bGUsIGAke3NoYWRlclR5cGV9OiR7dGhpcy5zaGFkZXIubGFiZWx9YCk7XG5cbiAgICAgICAgV2ViZ3B1RGVidWcuZW5kKGRldmljZSwge1xuICAgICAgICAgICAgc2hhZGVyVHlwZSxcbiAgICAgICAgICAgIHNvdXJjZTogY29kZSxcbiAgICAgICAgICAgIHNoYWRlcjogdGhpcy5zaGFkZXJcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHNoYWRlck1vZHVsZTtcbiAgICB9XG5cbiAgICBnZXRWZXJ0ZXhTaGFkZXJNb2R1bGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZVNoYWRlck1vZHVsZSh0aGlzLl92ZXJ0ZXhDb2RlLCAnVmVydGV4Jyk7XG4gICAgfVxuXG4gICAgZ2V0RnJhZ21lbnRTaGFkZXJNb2R1bGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZVNoYWRlck1vZHVsZSh0aGlzLl9mcmFnbWVudENvZGUsICdGcmFnbWVudCcpO1xuICAgIH1cblxuICAgIHByb2Nlc3MoKSB7XG4gICAgICAgIGNvbnN0IHNoYWRlciA9IHRoaXMuc2hhZGVyO1xuXG4gICAgICAgIC8vIHByb2Nlc3MgdGhlIHNoYWRlciBzb3VyY2UgdG8gYWxsb3cgZm9yIHVuaWZvcm1zXG4gICAgICAgIGNvbnN0IHByb2Nlc3NlZCA9IFNoYWRlclByb2Nlc3Nvci5ydW4oc2hhZGVyLmRldmljZSwgc2hhZGVyLmRlZmluaXRpb24sIHNoYWRlcik7XG5cbiAgICAgICAgLy8ga2VlcCByZWZlcmVuY2UgdG8gcHJvY2Vzc2VkIHNoYWRlcnMgaW4gZGVidWcgbW9kZVxuICAgICAgICBEZWJ1Zy5jYWxsKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMucHJvY2Vzc2VkID0gcHJvY2Vzc2VkO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLl92ZXJ0ZXhDb2RlID0gdGhpcy50cmFuc3BpbGUocHJvY2Vzc2VkLnZzaGFkZXIsICd2ZXJ0ZXgnLCBzaGFkZXIuZGVmaW5pdGlvbi52c2hhZGVyKTtcbiAgICAgICAgdGhpcy5fZnJhZ21lbnRDb2RlID0gdGhpcy50cmFuc3BpbGUocHJvY2Vzc2VkLmZzaGFkZXIsICdmcmFnbWVudCcsIHNoYWRlci5kZWZpbml0aW9uLmZzaGFkZXIpO1xuXG4gICAgICAgIGlmICghKHRoaXMuX3ZlcnRleENvZGUgJiYgdGhpcy5fZnJhZ21lbnRDb2RlKSkge1xuICAgICAgICAgICAgc2hhZGVyLmZhaWxlZCA9IHRydWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzaGFkZXIucmVhZHkgPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgc2hhZGVyLm1lc2hVbmlmb3JtQnVmZmVyRm9ybWF0ID0gcHJvY2Vzc2VkLm1lc2hVbmlmb3JtQnVmZmVyRm9ybWF0O1xuICAgICAgICBzaGFkZXIubWVzaEJpbmRHcm91cEZvcm1hdCA9IHByb2Nlc3NlZC5tZXNoQmluZEdyb3VwRm9ybWF0O1xuICAgIH1cblxuICAgIHRyYW5zcGlsZShzcmMsIHNoYWRlclR5cGUsIG9yaWdpbmFsU3JjKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBzcGlydiA9IHRoaXMuc2hhZGVyLmRldmljZS5nbHNsYW5nLmNvbXBpbGVHTFNMKHNyYywgc2hhZGVyVHlwZSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zaGFkZXIuZGV2aWNlLnR3Z3NsLmNvbnZlcnRTcGlyVjJXR1NMKHNwaXJ2KTtcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBGYWlsZWQgdG8gdHJhbnNwaWxlIHdlYmdsICR7c2hhZGVyVHlwZX0gc2hhZGVyIFske3RoaXMuc2hhZGVyLmxhYmVsfV0gdG8gV2ViR1BVOiBbJHtlcnIubWVzc2FnZX1dYCwge1xuICAgICAgICAgICAgICAgIHByb2Nlc3NlZDogc3JjLFxuICAgICAgICAgICAgICAgIG9yaWdpbmFsOiBvcmlnaW5hbFNyYyxcbiAgICAgICAgICAgICAgICBzaGFkZXI6IHRoaXMuc2hhZGVyXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldCB2ZXJ0ZXhDb2RlKCkge1xuICAgICAgICBEZWJ1Zy5hc3NlcnQodGhpcy5fdmVydGV4Q29kZSk7XG4gICAgICAgIHJldHVybiB0aGlzLl92ZXJ0ZXhDb2RlO1xuICAgIH1cblxuICAgIGdldCBmcmFnbWVudENvZGUoKSB7XG4gICAgICAgIERlYnVnLmFzc2VydCh0aGlzLl9mcmFnbWVudENvZGUpO1xuICAgICAgICByZXR1cm4gdGhpcy5fZnJhZ21lbnRDb2RlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERpc3Bvc2UgdGhlIHNoYWRlciB3aGVuIHRoZSBjb250ZXh0IGhhcyBiZWVuIGxvc3QuXG4gICAgICovXG4gICAgbG9zZUNvbnRleHQoKSB7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVzdG9yZSBzaGFkZXIgYWZ0ZXIgdGhlIGNvbnRleHQgaGFzIGJlZW4gb2J0YWluZWQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2ltcG9ydCgnLi4vZ3JhcGhpY3MtZGV2aWNlLmpzJykuR3JhcGhpY3NEZXZpY2V9IGRldmljZSAtIFRoZSBncmFwaGljcyBkZXZpY2UuXG4gICAgICogQHBhcmFtIHtpbXBvcnQoJy4uL3NoYWRlci5qcycpLlNoYWRlcn0gc2hhZGVyIC0gVGhlIHNoYWRlciB0byByZXN0b3JlLlxuICAgICAqL1xuICAgIHJlc3RvcmVDb250ZXh0KGRldmljZSwgc2hhZGVyKSB7XG4gICAgfVxufVxuXG5leHBvcnQgeyBXZWJncHVTaGFkZXIgfTtcbiJdLCJuYW1lcyI6WyJXZWJncHVTaGFkZXIiLCJjb25zdHJ1Y3RvciIsInNoYWRlciIsIl92ZXJ0ZXhDb2RlIiwiX2ZyYWdtZW50Q29kZSIsInZlcnRleEVudHJ5UG9pbnQiLCJmcmFnbWVudEVudHJ5UG9pbnQiLCJkZWZpbml0aW9uIiwiRGVidWciLCJhc3NlcnQiLCJzaGFkZXJMYW5ndWFnZSIsIlNIQURFUkxBTkdVQUdFX1dHU0wiLCJ2c2hhZGVyIiwiZnNoYWRlciIsInJlYWR5IiwicHJvY2Vzc2luZ09wdGlvbnMiLCJwcm9jZXNzIiwiZGVzdHJveSIsImNyZWF0ZVNoYWRlck1vZHVsZSIsImNvZGUiLCJzaGFkZXJUeXBlIiwiZGV2aWNlIiwid2dwdSIsIldlYmdwdURlYnVnIiwidmFsaWRhdGUiLCJzaGFkZXJNb2R1bGUiLCJEZWJ1Z0hlbHBlciIsInNldExhYmVsIiwibGFiZWwiLCJlbmQiLCJzb3VyY2UiLCJnZXRWZXJ0ZXhTaGFkZXJNb2R1bGUiLCJnZXRGcmFnbWVudFNoYWRlck1vZHVsZSIsInByb2Nlc3NlZCIsIlNoYWRlclByb2Nlc3NvciIsInJ1biIsImNhbGwiLCJ0cmFuc3BpbGUiLCJmYWlsZWQiLCJtZXNoVW5pZm9ybUJ1ZmZlckZvcm1hdCIsIm1lc2hCaW5kR3JvdXBGb3JtYXQiLCJzcmMiLCJvcmlnaW5hbFNyYyIsInNwaXJ2IiwiZ2xzbGFuZyIsImNvbXBpbGVHTFNMIiwidHdnc2wiLCJjb252ZXJ0U3BpclYyV0dTTCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsIm1lc3NhZ2UiLCJvcmlnaW5hbCIsInZl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
