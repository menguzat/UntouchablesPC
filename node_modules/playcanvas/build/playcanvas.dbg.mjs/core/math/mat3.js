import { Vec3 } from './vec3.js';

/**
 * A 3x3 matrix.
 */
class Mat3 {
  /**
   * Create a new Mat3 instance. It is initialized to the identity matrix.
   */
  constructor() {
    /**
     * Matrix elements in the form of a flat array.
     *
     * @type {Float32Array}
     */
    this.data = new Float32Array(9);
    // Create an identity matrix. Note that a new Float32Array has all elements set
    // to zero by default, so we only need to set the relevant elements to one.
    this.data[0] = this.data[4] = this.data[8] = 1;
  }

  /**
   * Creates a duplicate of the specified matrix.
   *
   * @returns {this} A duplicate matrix.
   * @example
   * const src = new pc.Mat3().translate(10, 20, 30);
   * const dst = src.clone();
   * console.log("The two matrices are " + (src.equals(dst) ? "equal" : "different"));
   */
  clone() {
    /** @type {this} */
    const cstr = this.constructor;
    return new cstr().copy(this);
  }

  /**
   * Copies the contents of a source 3x3 matrix to a destination 3x3 matrix.
   *
   * @param {Mat3} rhs - A 3x3 matrix to be copied.
   * @returns {Mat3} Self for chaining.
   * @example
   * const src = new pc.Mat3().translate(10, 20, 30);
   * const dst = new pc.Mat3();
   * dst.copy(src);
   * console.log("The two matrices are " + (src.equals(dst) ? "equal" : "different"));
   */
  copy(rhs) {
    const src = rhs.data;
    const dst = this.data;
    dst[0] = src[0];
    dst[1] = src[1];
    dst[2] = src[2];
    dst[3] = src[3];
    dst[4] = src[4];
    dst[5] = src[5];
    dst[6] = src[6];
    dst[7] = src[7];
    dst[8] = src[8];
    return this;
  }

  /**
   * Copies the contents of a source array[9] to a destination 3x3 matrix.
   *
   * @param {number[]} src - An array[9] to be copied.
   * @returns {Mat3} Self for chaining.
   * @example
   * const dst = new pc.Mat3();
   * dst.set([0, 1, 2, 3, 4, 5, 6, 7, 8]);
   */
  set(src) {
    const dst = this.data;
    dst[0] = src[0];
    dst[1] = src[1];
    dst[2] = src[2];
    dst[3] = src[3];
    dst[4] = src[4];
    dst[5] = src[5];
    dst[6] = src[6];
    dst[7] = src[7];
    dst[8] = src[8];
    return this;
  }

  /**
   * Reports whether two matrices are equal.
   *
   * @param {Mat3} rhs - The other matrix.
   * @returns {boolean} True if the matrices are equal and false otherwise.
   * @example
   * const a = new pc.Mat3().translate(10, 20, 30);
   * const b = new pc.Mat3();
   * console.log("The two matrices are " + (a.equals(b) ? "equal" : "different"));
   */
  equals(rhs) {
    const l = this.data;
    const r = rhs.data;
    return l[0] === r[0] && l[1] === r[1] && l[2] === r[2] && l[3] === r[3] && l[4] === r[4] && l[5] === r[5] && l[6] === r[6] && l[7] === r[7] && l[8] === r[8];
  }

  /**
   * Reports whether the specified matrix is the identity matrix.
   *
   * @returns {boolean} True if the matrix is identity and false otherwise.
   * @example
   * const m = new pc.Mat3();
   * console.log("The matrix is " + (m.isIdentity() ? "identity" : "not identity"));
   */
  isIdentity() {
    const m = this.data;
    return m[0] === 1 && m[1] === 0 && m[2] === 0 && m[3] === 0 && m[4] === 1 && m[5] === 0 && m[6] === 0 && m[7] === 0 && m[8] === 1;
  }

  /**
   * Sets the matrix to the identity matrix.
   *
   * @returns {Mat3} Self for chaining.
   * @example
   * m.setIdentity();
   * console.log("The matrix is " + (m.isIdentity() ? "identity" : "not identity"));
   */
  setIdentity() {
    const m = this.data;
    m[0] = 1;
    m[1] = 0;
    m[2] = 0;
    m[3] = 0;
    m[4] = 1;
    m[5] = 0;
    m[6] = 0;
    m[7] = 0;
    m[8] = 1;
    return this;
  }

  /**
   * Converts the matrix to string form.
   *
   * @returns {string} The matrix in string form.
   * @example
   * const m = new pc.Mat3();
   * // Outputs [1, 0, 0, 0, 1, 0, 0, 0, 1]
   * console.log(m.toString());
   */
  toString() {
    return '[' + this.data.join(', ') + ']';
  }

  /**
   * Generates the transpose of the specified 3x3 matrix.
   *
   * @returns {Mat3} Self for chaining.
   * @example
   * const m = new pc.Mat3();
   *
   * // Transpose in place
   * m.transpose();
   */
  transpose() {
    const m = this.data;
    let tmp;
    tmp = m[1];
    m[1] = m[3];
    m[3] = tmp;
    tmp = m[2];
    m[2] = m[6];
    m[6] = tmp;
    tmp = m[5];
    m[5] = m[7];
    m[7] = tmp;
    return this;
  }

  /**
   * Converts the specified 4x4 matrix to a Mat3.
   *
   * @param {import('./mat4.js').Mat4} m - The 4x4 matrix to convert.
   * @returns {Mat3} Self for chaining.
   */
  setFromMat4(m) {
    const src = m.data;
    const dst = this.data;
    dst[0] = src[0];
    dst[1] = src[1];
    dst[2] = src[2];
    dst[3] = src[4];
    dst[4] = src[5];
    dst[5] = src[6];
    dst[6] = src[8];
    dst[7] = src[9];
    dst[8] = src[10];
    return this;
  }

  /**
   * Transforms a 3-dimensional vector by a 3x3 matrix.
   *
   * @param {Vec3} vec - The 3-dimensional vector to be transformed.
   * @param {Vec3} [res] - An optional 3-dimensional vector to receive the result of the
   * transformation.
   * @returns {Vec3} The input vector v transformed by the current instance.
   */
  transformVector(vec, res = new Vec3()) {
    const m = this.data;
    const x = vec.x;
    const y = vec.y;
    const z = vec.z;
    res.x = x * m[0] + y * m[3] + z * m[6];
    res.y = x * m[1] + y * m[4] + z * m[7];
    res.z = x * m[2] + y * m[5] + z * m[8];
    return res;
  }

  /**
   * A constant matrix set to the identity.
   *
   * @type {Mat3}
   * @readonly
   */
}
Mat3.IDENTITY = Object.freeze(new Mat3());
/**
 * A constant matrix with all elements set to 0.
 *
 * @type {Mat3}
 * @readonly
 */
Mat3.ZERO = Object.freeze(new Mat3().set([0, 0, 0, 0, 0, 0, 0, 0, 0]));

export { Mat3 };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWF0My5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2NvcmUvbWF0aC9tYXQzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFZlYzMgfSBmcm9tICcuL3ZlYzMuanMnO1xuXG4vKipcbiAqIEEgM3gzIG1hdHJpeC5cbiAqL1xuY2xhc3MgTWF0MyB7XG4gICAgLyoqXG4gICAgICogTWF0cml4IGVsZW1lbnRzIGluIHRoZSBmb3JtIG9mIGEgZmxhdCBhcnJheS5cbiAgICAgKlxuICAgICAqIEB0eXBlIHtGbG9hdDMyQXJyYXl9XG4gICAgICovXG4gICAgZGF0YSA9IG5ldyBGbG9hdDMyQXJyYXkoOSk7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSBuZXcgTWF0MyBpbnN0YW5jZS4gSXQgaXMgaW5pdGlhbGl6ZWQgdG8gdGhlIGlkZW50aXR5IG1hdHJpeC5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgLy8gQ3JlYXRlIGFuIGlkZW50aXR5IG1hdHJpeC4gTm90ZSB0aGF0IGEgbmV3IEZsb2F0MzJBcnJheSBoYXMgYWxsIGVsZW1lbnRzIHNldFxuICAgICAgICAvLyB0byB6ZXJvIGJ5IGRlZmF1bHQsIHNvIHdlIG9ubHkgbmVlZCB0byBzZXQgdGhlIHJlbGV2YW50IGVsZW1lbnRzIHRvIG9uZS5cbiAgICAgICAgdGhpcy5kYXRhWzBdID0gdGhpcy5kYXRhWzRdID0gdGhpcy5kYXRhWzhdID0gMTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgZHVwbGljYXRlIG9mIHRoZSBzcGVjaWZpZWQgbWF0cml4LlxuICAgICAqXG4gICAgICogQHJldHVybnMge3RoaXN9IEEgZHVwbGljYXRlIG1hdHJpeC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIGNvbnN0IHNyYyA9IG5ldyBwYy5NYXQzKCkudHJhbnNsYXRlKDEwLCAyMCwgMzApO1xuICAgICAqIGNvbnN0IGRzdCA9IHNyYy5jbG9uZSgpO1xuICAgICAqIGNvbnNvbGUubG9nKFwiVGhlIHR3byBtYXRyaWNlcyBhcmUgXCIgKyAoc3JjLmVxdWFscyhkc3QpID8gXCJlcXVhbFwiIDogXCJkaWZmZXJlbnRcIikpO1xuICAgICAqL1xuICAgIGNsb25lKCkge1xuICAgICAgICAvKiogQHR5cGUge3RoaXN9ICovXG4gICAgICAgIGNvbnN0IGNzdHIgPSB0aGlzLmNvbnN0cnVjdG9yO1xuICAgICAgICByZXR1cm4gbmV3IGNzdHIoKS5jb3B5KHRoaXMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENvcGllcyB0aGUgY29udGVudHMgb2YgYSBzb3VyY2UgM3gzIG1hdHJpeCB0byBhIGRlc3RpbmF0aW9uIDN4MyBtYXRyaXguXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge01hdDN9IHJocyAtIEEgM3gzIG1hdHJpeCB0byBiZSBjb3BpZWQuXG4gICAgICogQHJldHVybnMge01hdDN9IFNlbGYgZm9yIGNoYWluaW5nLlxuICAgICAqIEBleGFtcGxlXG4gICAgICogY29uc3Qgc3JjID0gbmV3IHBjLk1hdDMoKS50cmFuc2xhdGUoMTAsIDIwLCAzMCk7XG4gICAgICogY29uc3QgZHN0ID0gbmV3IHBjLk1hdDMoKTtcbiAgICAgKiBkc3QuY29weShzcmMpO1xuICAgICAqIGNvbnNvbGUubG9nKFwiVGhlIHR3byBtYXRyaWNlcyBhcmUgXCIgKyAoc3JjLmVxdWFscyhkc3QpID8gXCJlcXVhbFwiIDogXCJkaWZmZXJlbnRcIikpO1xuICAgICAqL1xuICAgIGNvcHkocmhzKSB7XG4gICAgICAgIGNvbnN0IHNyYyA9IHJocy5kYXRhO1xuICAgICAgICBjb25zdCBkc3QgPSB0aGlzLmRhdGE7XG5cbiAgICAgICAgZHN0WzBdID0gc3JjWzBdO1xuICAgICAgICBkc3RbMV0gPSBzcmNbMV07XG4gICAgICAgIGRzdFsyXSA9IHNyY1syXTtcbiAgICAgICAgZHN0WzNdID0gc3JjWzNdO1xuICAgICAgICBkc3RbNF0gPSBzcmNbNF07XG4gICAgICAgIGRzdFs1XSA9IHNyY1s1XTtcbiAgICAgICAgZHN0WzZdID0gc3JjWzZdO1xuICAgICAgICBkc3RbN10gPSBzcmNbN107XG4gICAgICAgIGRzdFs4XSA9IHNyY1s4XTtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb3BpZXMgdGhlIGNvbnRlbnRzIG9mIGEgc291cmNlIGFycmF5WzldIHRvIGEgZGVzdGluYXRpb24gM3gzIG1hdHJpeC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyW119IHNyYyAtIEFuIGFycmF5WzldIHRvIGJlIGNvcGllZC5cbiAgICAgKiBAcmV0dXJucyB7TWF0M30gU2VsZiBmb3IgY2hhaW5pbmcuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBjb25zdCBkc3QgPSBuZXcgcGMuTWF0MygpO1xuICAgICAqIGRzdC5zZXQoWzAsIDEsIDIsIDMsIDQsIDUsIDYsIDcsIDhdKTtcbiAgICAgKi9cbiAgICBzZXQoc3JjKSB7XG4gICAgICAgIGNvbnN0IGRzdCA9IHRoaXMuZGF0YTtcblxuICAgICAgICBkc3RbMF0gPSBzcmNbMF07XG4gICAgICAgIGRzdFsxXSA9IHNyY1sxXTtcbiAgICAgICAgZHN0WzJdID0gc3JjWzJdO1xuICAgICAgICBkc3RbM10gPSBzcmNbM107XG4gICAgICAgIGRzdFs0XSA9IHNyY1s0XTtcbiAgICAgICAgZHN0WzVdID0gc3JjWzVdO1xuICAgICAgICBkc3RbNl0gPSBzcmNbNl07XG4gICAgICAgIGRzdFs3XSA9IHNyY1s3XTtcbiAgICAgICAgZHN0WzhdID0gc3JjWzhdO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlcG9ydHMgd2hldGhlciB0d28gbWF0cmljZXMgYXJlIGVxdWFsLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtNYXQzfSByaHMgLSBUaGUgb3RoZXIgbWF0cml4LlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHRoZSBtYXRyaWNlcyBhcmUgZXF1YWwgYW5kIGZhbHNlIG90aGVyd2lzZS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIGNvbnN0IGEgPSBuZXcgcGMuTWF0MygpLnRyYW5zbGF0ZSgxMCwgMjAsIDMwKTtcbiAgICAgKiBjb25zdCBiID0gbmV3IHBjLk1hdDMoKTtcbiAgICAgKiBjb25zb2xlLmxvZyhcIlRoZSB0d28gbWF0cmljZXMgYXJlIFwiICsgKGEuZXF1YWxzKGIpID8gXCJlcXVhbFwiIDogXCJkaWZmZXJlbnRcIikpO1xuICAgICAqL1xuICAgIGVxdWFscyhyaHMpIHtcbiAgICAgICAgY29uc3QgbCA9IHRoaXMuZGF0YTtcbiAgICAgICAgY29uc3QgciA9IHJocy5kYXRhO1xuXG4gICAgICAgIHJldHVybiAoKGxbMF0gPT09IHJbMF0pICYmXG4gICAgICAgICAgICAgICAgKGxbMV0gPT09IHJbMV0pICYmXG4gICAgICAgICAgICAgICAgKGxbMl0gPT09IHJbMl0pICYmXG4gICAgICAgICAgICAgICAgKGxbM10gPT09IHJbM10pICYmXG4gICAgICAgICAgICAgICAgKGxbNF0gPT09IHJbNF0pICYmXG4gICAgICAgICAgICAgICAgKGxbNV0gPT09IHJbNV0pICYmXG4gICAgICAgICAgICAgICAgKGxbNl0gPT09IHJbNl0pICYmXG4gICAgICAgICAgICAgICAgKGxbN10gPT09IHJbN10pICYmXG4gICAgICAgICAgICAgICAgKGxbOF0gPT09IHJbOF0pKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXBvcnRzIHdoZXRoZXIgdGhlIHNwZWNpZmllZCBtYXRyaXggaXMgdGhlIGlkZW50aXR5IG1hdHJpeC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHRoZSBtYXRyaXggaXMgaWRlbnRpdHkgYW5kIGZhbHNlIG90aGVyd2lzZS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIGNvbnN0IG0gPSBuZXcgcGMuTWF0MygpO1xuICAgICAqIGNvbnNvbGUubG9nKFwiVGhlIG1hdHJpeCBpcyBcIiArIChtLmlzSWRlbnRpdHkoKSA/IFwiaWRlbnRpdHlcIiA6IFwibm90IGlkZW50aXR5XCIpKTtcbiAgICAgKi9cbiAgICBpc0lkZW50aXR5KCkge1xuICAgICAgICBjb25zdCBtID0gdGhpcy5kYXRhO1xuICAgICAgICByZXR1cm4gKChtWzBdID09PSAxKSAmJlxuICAgICAgICAgICAgICAgIChtWzFdID09PSAwKSAmJlxuICAgICAgICAgICAgICAgIChtWzJdID09PSAwKSAmJlxuICAgICAgICAgICAgICAgIChtWzNdID09PSAwKSAmJlxuICAgICAgICAgICAgICAgIChtWzRdID09PSAxKSAmJlxuICAgICAgICAgICAgICAgIChtWzVdID09PSAwKSAmJlxuICAgICAgICAgICAgICAgIChtWzZdID09PSAwKSAmJlxuICAgICAgICAgICAgICAgIChtWzddID09PSAwKSAmJlxuICAgICAgICAgICAgICAgIChtWzhdID09PSAxKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgbWF0cml4IHRvIHRoZSBpZGVudGl0eSBtYXRyaXguXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7TWF0M30gU2VsZiBmb3IgY2hhaW5pbmcuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBtLnNldElkZW50aXR5KCk7XG4gICAgICogY29uc29sZS5sb2coXCJUaGUgbWF0cml4IGlzIFwiICsgKG0uaXNJZGVudGl0eSgpID8gXCJpZGVudGl0eVwiIDogXCJub3QgaWRlbnRpdHlcIikpO1xuICAgICAqL1xuICAgIHNldElkZW50aXR5KCkge1xuICAgICAgICBjb25zdCBtID0gdGhpcy5kYXRhO1xuICAgICAgICBtWzBdID0gMTtcbiAgICAgICAgbVsxXSA9IDA7XG4gICAgICAgIG1bMl0gPSAwO1xuXG4gICAgICAgIG1bM10gPSAwO1xuICAgICAgICBtWzRdID0gMTtcbiAgICAgICAgbVs1XSA9IDA7XG5cbiAgICAgICAgbVs2XSA9IDA7XG4gICAgICAgIG1bN10gPSAwO1xuICAgICAgICBtWzhdID0gMTtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0cyB0aGUgbWF0cml4IHRvIHN0cmluZyBmb3JtLlxuICAgICAqXG4gICAgICogQHJldHVybnMge3N0cmluZ30gVGhlIG1hdHJpeCBpbiBzdHJpbmcgZm9ybS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIGNvbnN0IG0gPSBuZXcgcGMuTWF0MygpO1xuICAgICAqIC8vIE91dHB1dHMgWzEsIDAsIDAsIDAsIDEsIDAsIDAsIDAsIDFdXG4gICAgICogY29uc29sZS5sb2cobS50b1N0cmluZygpKTtcbiAgICAgKi9cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuICdbJyArIHRoaXMuZGF0YS5qb2luKCcsICcpICsgJ10nO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdlbmVyYXRlcyB0aGUgdHJhbnNwb3NlIG9mIHRoZSBzcGVjaWZpZWQgM3gzIG1hdHJpeC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtNYXQzfSBTZWxmIGZvciBjaGFpbmluZy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIGNvbnN0IG0gPSBuZXcgcGMuTWF0MygpO1xuICAgICAqXG4gICAgICogLy8gVHJhbnNwb3NlIGluIHBsYWNlXG4gICAgICogbS50cmFuc3Bvc2UoKTtcbiAgICAgKi9cbiAgICB0cmFuc3Bvc2UoKSB7XG4gICAgICAgIGNvbnN0IG0gPSB0aGlzLmRhdGE7XG5cbiAgICAgICAgbGV0IHRtcDtcbiAgICAgICAgdG1wID0gbVsxXTsgbVsxXSA9IG1bM107IG1bM10gPSB0bXA7XG4gICAgICAgIHRtcCA9IG1bMl07IG1bMl0gPSBtWzZdOyBtWzZdID0gdG1wO1xuICAgICAgICB0bXAgPSBtWzVdOyBtWzVdID0gbVs3XTsgbVs3XSA9IHRtcDtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0cyB0aGUgc3BlY2lmaWVkIDR4NCBtYXRyaXggdG8gYSBNYXQzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtpbXBvcnQoJy4vbWF0NC5qcycpLk1hdDR9IG0gLSBUaGUgNHg0IG1hdHJpeCB0byBjb252ZXJ0LlxuICAgICAqIEByZXR1cm5zIHtNYXQzfSBTZWxmIGZvciBjaGFpbmluZy5cbiAgICAgKi9cbiAgICBzZXRGcm9tTWF0NChtKSB7XG4gICAgICAgIGNvbnN0IHNyYyA9IG0uZGF0YTtcbiAgICAgICAgY29uc3QgZHN0ID0gdGhpcy5kYXRhO1xuXG4gICAgICAgIGRzdFswXSA9IHNyY1swXTtcbiAgICAgICAgZHN0WzFdID0gc3JjWzFdO1xuICAgICAgICBkc3RbMl0gPSBzcmNbMl07XG5cbiAgICAgICAgZHN0WzNdID0gc3JjWzRdO1xuICAgICAgICBkc3RbNF0gPSBzcmNbNV07XG4gICAgICAgIGRzdFs1XSA9IHNyY1s2XTtcblxuICAgICAgICBkc3RbNl0gPSBzcmNbOF07XG4gICAgICAgIGRzdFs3XSA9IHNyY1s5XTtcbiAgICAgICAgZHN0WzhdID0gc3JjWzEwXTtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUcmFuc2Zvcm1zIGEgMy1kaW1lbnNpb25hbCB2ZWN0b3IgYnkgYSAzeDMgbWF0cml4LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtWZWMzfSB2ZWMgLSBUaGUgMy1kaW1lbnNpb25hbCB2ZWN0b3IgdG8gYmUgdHJhbnNmb3JtZWQuXG4gICAgICogQHBhcmFtIHtWZWMzfSBbcmVzXSAtIEFuIG9wdGlvbmFsIDMtZGltZW5zaW9uYWwgdmVjdG9yIHRvIHJlY2VpdmUgdGhlIHJlc3VsdCBvZiB0aGVcbiAgICAgKiB0cmFuc2Zvcm1hdGlvbi5cbiAgICAgKiBAcmV0dXJucyB7VmVjM30gVGhlIGlucHV0IHZlY3RvciB2IHRyYW5zZm9ybWVkIGJ5IHRoZSBjdXJyZW50IGluc3RhbmNlLlxuICAgICAqL1xuICAgIHRyYW5zZm9ybVZlY3Rvcih2ZWMsIHJlcyA9IG5ldyBWZWMzKCkpIHtcbiAgICAgICAgY29uc3QgbSA9IHRoaXMuZGF0YTtcblxuICAgICAgICBjb25zdCB4ID0gdmVjLng7XG4gICAgICAgIGNvbnN0IHkgPSB2ZWMueTtcbiAgICAgICAgY29uc3QgeiA9IHZlYy56O1xuXG4gICAgICAgIHJlcy54ID0geCAqIG1bMF0gKyB5ICogbVszXSArIHogKiBtWzZdO1xuICAgICAgICByZXMueSA9IHggKiBtWzFdICsgeSAqIG1bNF0gKyB6ICogbVs3XTtcbiAgICAgICAgcmVzLnogPSB4ICogbVsyXSArIHkgKiBtWzVdICsgeiAqIG1bOF07XG5cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBIGNvbnN0YW50IG1hdHJpeCBzZXQgdG8gdGhlIGlkZW50aXR5LlxuICAgICAqXG4gICAgICogQHR5cGUge01hdDN9XG4gICAgICogQHJlYWRvbmx5XG4gICAgICovXG4gICAgc3RhdGljIElERU5USVRZID0gT2JqZWN0LmZyZWV6ZShuZXcgTWF0MygpKTtcblxuICAgIC8qKlxuICAgICAqIEEgY29uc3RhbnQgbWF0cml4IHdpdGggYWxsIGVsZW1lbnRzIHNldCB0byAwLlxuICAgICAqXG4gICAgICogQHR5cGUge01hdDN9XG4gICAgICogQHJlYWRvbmx5XG4gICAgICovXG4gICAgc3RhdGljIFpFUk8gPSBPYmplY3QuZnJlZXplKG5ldyBNYXQzKCkuc2V0KFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXSkpO1xufVxuXG5leHBvcnQgeyBNYXQzIH07XG4iXSwibmFtZXMiOlsiTWF0MyIsImNvbnN0cnVjdG9yIiwiZGF0YSIsIkZsb2F0MzJBcnJheSIsImNsb25lIiwiY3N0ciIsImNvcHkiLCJyaHMiLCJzcmMiLCJkc3QiLCJzZXQiLCJlcXVhbHMiLCJsIiwiciIsImlzSWRlbnRpdHkiLCJtIiwic2V0SWRlbnRpdHkiLCJ0b1N0cmluZyIsImpvaW4iLCJ0cmFuc3Bvc2UiLCJ0bXAiLCJzZXRGcm9tTWF0NCIsInRyYW5zZm9ybVZlY3RvciIsInZlYyIsInJlcyIsIlZlYzMiLCJ4IiwieSIsInoiLCJJREVOVElUWSIsIk9iamVjdCIsImZyZWV6ZSIsIlpFUk8iXSwibWFwcGluZ3MiOiI7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTUEsSUFBSSxDQUFDO0FBUVA7QUFDSjtBQUNBO0FBQ0lDLEVBQUFBLFdBQVdBLEdBQUc7QUFWZDtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBSkksSUFBQSxJQUFBLENBS0FDLElBQUksR0FBRyxJQUFJQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUE7QUFNdEI7QUFDQTtJQUNBLElBQUksQ0FBQ0QsSUFBSSxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQ0EsSUFBSSxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQ0EsSUFBSSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQTtBQUNsRCxHQUFBOztBQUVBO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJRSxFQUFBQSxLQUFLQSxHQUFHO0FBQ0o7QUFDQSxJQUFBLE1BQU1DLElBQUksR0FBRyxJQUFJLENBQUNKLFdBQVcsQ0FBQTtJQUM3QixPQUFPLElBQUlJLElBQUksRUFBRSxDQUFDQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUE7QUFDaEMsR0FBQTs7QUFFQTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0VBQ0lBLElBQUlBLENBQUNDLEdBQUcsRUFBRTtBQUNOLElBQUEsTUFBTUMsR0FBRyxHQUFHRCxHQUFHLENBQUNMLElBQUksQ0FBQTtBQUNwQixJQUFBLE1BQU1PLEdBQUcsR0FBRyxJQUFJLENBQUNQLElBQUksQ0FBQTtBQUVyQk8sSUFBQUEsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHRCxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUE7QUFDZkMsSUFBQUEsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHRCxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUE7QUFDZkMsSUFBQUEsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHRCxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUE7QUFDZkMsSUFBQUEsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHRCxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUE7QUFDZkMsSUFBQUEsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHRCxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUE7QUFDZkMsSUFBQUEsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHRCxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUE7QUFDZkMsSUFBQUEsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHRCxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUE7QUFDZkMsSUFBQUEsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHRCxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUE7QUFDZkMsSUFBQUEsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHRCxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUE7QUFFZixJQUFBLE9BQU8sSUFBSSxDQUFBO0FBQ2YsR0FBQTs7QUFFQTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7RUFDSUUsR0FBR0EsQ0FBQ0YsR0FBRyxFQUFFO0FBQ0wsSUFBQSxNQUFNQyxHQUFHLEdBQUcsSUFBSSxDQUFDUCxJQUFJLENBQUE7QUFFckJPLElBQUFBLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBR0QsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFBO0FBQ2ZDLElBQUFBLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBR0QsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFBO0FBQ2ZDLElBQUFBLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBR0QsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFBO0FBQ2ZDLElBQUFBLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBR0QsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFBO0FBQ2ZDLElBQUFBLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBR0QsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFBO0FBQ2ZDLElBQUFBLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBR0QsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFBO0FBQ2ZDLElBQUFBLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBR0QsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFBO0FBQ2ZDLElBQUFBLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBR0QsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFBO0FBQ2ZDLElBQUFBLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBR0QsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFBO0FBRWYsSUFBQSxPQUFPLElBQUksQ0FBQTtBQUNmLEdBQUE7O0FBRUE7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7RUFDSUcsTUFBTUEsQ0FBQ0osR0FBRyxFQUFFO0FBQ1IsSUFBQSxNQUFNSyxDQUFDLEdBQUcsSUFBSSxDQUFDVixJQUFJLENBQUE7QUFDbkIsSUFBQSxNQUFNVyxDQUFDLEdBQUdOLEdBQUcsQ0FBQ0wsSUFBSSxDQUFBO0FBRWxCLElBQUEsT0FBU1UsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQ2JELENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBS0MsQ0FBQyxDQUFDLENBQUMsQ0FBRSxJQUNkRCxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUtDLENBQUMsQ0FBQyxDQUFDLENBQUUsSUFDZEQsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLQyxDQUFDLENBQUMsQ0FBQyxDQUFFLElBQ2RELENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBS0MsQ0FBQyxDQUFDLENBQUMsQ0FBRSxJQUNkRCxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUtDLENBQUMsQ0FBQyxDQUFDLENBQUUsSUFDZEQsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLQyxDQUFDLENBQUMsQ0FBQyxDQUFFLElBQ2RELENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBS0MsQ0FBQyxDQUFDLENBQUMsQ0FBRSxJQUNkRCxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUtDLENBQUMsQ0FBQyxDQUFDLENBQUUsQ0FBQTtBQUMzQixHQUFBOztBQUVBO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSUMsRUFBQUEsVUFBVUEsR0FBRztBQUNULElBQUEsTUFBTUMsQ0FBQyxHQUFHLElBQUksQ0FBQ2IsSUFBSSxDQUFBO0FBQ25CLElBQUEsT0FBU2EsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsSUFDVkEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUUsSUFDWEEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUUsSUFDWEEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUUsSUFDWEEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUUsSUFDWEEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUUsSUFDWEEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUUsSUFDWEEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUUsSUFDWEEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUUsQ0FBQTtBQUN4QixHQUFBOztBQUVBO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSUMsRUFBQUEsV0FBV0EsR0FBRztBQUNWLElBQUEsTUFBTUQsQ0FBQyxHQUFHLElBQUksQ0FBQ2IsSUFBSSxDQUFBO0FBQ25CYSxJQUFBQSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFBO0FBQ1JBLElBQUFBLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUE7QUFDUkEsSUFBQUEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQTtBQUVSQSxJQUFBQSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFBO0FBQ1JBLElBQUFBLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUE7QUFDUkEsSUFBQUEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQTtBQUVS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
