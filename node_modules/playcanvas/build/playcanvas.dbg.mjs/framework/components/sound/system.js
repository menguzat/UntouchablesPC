import { Debug } from '../../../core/debug.js';
import { hasAudioContext } from '../../../platform/audio/capabilities.js';
import { Component } from '../component.js';
import { ComponentSystem } from '../system.js';
import { SoundComponent } from './component.js';
import { SoundComponentData } from './data.js';

const _schema = ['enabled'];

/**
 * Manages creation of {@link SoundComponent}s.
 *
 * @augments ComponentSystem
 */
class SoundComponentSystem extends ComponentSystem {
  /**
   * Create a SoundComponentSystem.
   *
   * @param {import('../../app-base.js').AppBase} app - The Application.
   * @hideconstructor
   */
  constructor(app) {
    super(app);
    this.id = 'sound';
    this.ComponentType = SoundComponent;
    this.DataType = SoundComponentData;
    this.schema = _schema;

    /**
     * Gets / sets the sound manager.
     *
     * @type {import('../../../platform/sound/manager.js').SoundManager}
     */
    this.manager = app.soundManager;
    Debug.assert(this.manager, "AudioSourceComponentSystem cannot be created without sound manager");
    this.app.systems.on('update', this.onUpdate, this);
    this.on('beforeremove', this.onBeforeRemove, this);
  }

  /**
   * Sets / gets the volume for the entire Sound system. All sounds will have their volume
   * multiplied by this value. Valid between [0, 1].
   *
   * @type {number}
   */
  set volume(volume) {
    this.manager.volume = volume;
  }
  get volume() {
    return this.manager.volume;
  }

  /**
   * Gets the AudioContext currently used by the sound manager. Requires Web Audio API support.
   * Returns null if the device does not support the Web Audio API.
   *
   * @type {AudioContext|null}
   */
  get context() {
    if (!hasAudioContext()) {
      Debug.warn('WARNING: Audio context is not supported on this browser');
      return null;
    }
    return this.manager.context;
  }
  initializeComponentData(component, data, properties) {
    properties = ['volume', 'pitch', 'positional', 'refDistance', 'maxDistance', 'rollOffFactor', 'distanceModel', 'slots'];
    for (let i = 0; i < properties.length; i++) {
      if (data.hasOwnProperty(properties[i])) {
        component[properties[i]] = data[properties[i]];
      }
    }
    super.initializeComponentData(component, data, ['enabled']);
  }
  cloneComponent(entity, clone) {
    const srcComponent = entity.sound;
    const srcSlots = srcComponent.slots;

    // convert 'slots' back to
    // simple option objects
    const slots = {};
    for (const key in srcSlots) {
      const srcSlot = srcSlots[key];
      slots[key] = {
        name: srcSlot.name,
        volume: srcSlot.volume,
        pitch: srcSlot.pitch,
        loop: srcSlot.loop,
        duration: srcSlot.duration,
        startTime: srcSlot.startTime,
        overlap: srcSlot.overlap,
        autoPlay: srcSlot.autoPlay,
        asset: srcSlot.asset
      };
    }
    const cloneData = {
      distanceModel: srcComponent.distanceModel,
      enabled: srcComponent.enabled,
      maxDistance: srcComponent.maxDistance,
      pitch: srcComponent.pitch,
      positional: srcComponent.positional,
      refDistance: srcComponent.refDistance,
      rollOffFactor: srcComponent.rollOffFactor,
      slots: slots,
      volume: srcComponent.volume
    };

    // add component with new data
    return this.addComponent(clone, cloneData);
  }
  onUpdate(dt) {
    const store = this.store;
    for (const id in store) {
      if (store.hasOwnProperty(id)) {
        const item = store[id];
        const entity = item.entity;
        if (entity.enabled) {
          const component = entity.sound;

          // Update slot position if this is a 3d sound
          if (component.enabled && component.positional) {
            const position = entity.getPosition();
            const slots = component.slots;
            for (const key in slots) {
              slots[key].updatePosition(position);
            }
          }
        }
      }
    }
  }
  onBeforeRemove(entity, component) {
    const slots = component.slots;
    // stop non overlapping sounds
    for (const key in slots) {
      if (!slots[key].overlap) {
        slots[key].stop();
      }
    }
    component.onRemove();
  }
  destroy() {
    super.destroy();
    this.app.systems.off('update', this.onUpdate, this);
  }
}
Component._buildAccessors(SoundComponent.prototype, _schema);

export { SoundComponentSystem };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3lzdGVtLmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvZnJhbWV3b3JrL2NvbXBvbmVudHMvc291bmQvc3lzdGVtLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERlYnVnIH0gZnJvbSAnLi4vLi4vLi4vY29yZS9kZWJ1Zy5qcyc7XG5cbmltcG9ydCB7IGhhc0F1ZGlvQ29udGV4dCB9IGZyb20gJy4uLy4uLy4uL3BsYXRmb3JtL2F1ZGlvL2NhcGFiaWxpdGllcy5qcyc7XG5cbmltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gJy4uL2NvbXBvbmVudC5qcyc7XG5pbXBvcnQgeyBDb21wb25lbnRTeXN0ZW0gfSBmcm9tICcuLi9zeXN0ZW0uanMnO1xuXG5pbXBvcnQgeyBTb3VuZENvbXBvbmVudCB9IGZyb20gJy4vY29tcG9uZW50LmpzJztcbmltcG9ydCB7IFNvdW5kQ29tcG9uZW50RGF0YSB9IGZyb20gJy4vZGF0YS5qcyc7XG5cbmNvbnN0IF9zY2hlbWEgPSBbJ2VuYWJsZWQnXTtcblxuLyoqXG4gKiBNYW5hZ2VzIGNyZWF0aW9uIG9mIHtAbGluayBTb3VuZENvbXBvbmVudH1zLlxuICpcbiAqIEBhdWdtZW50cyBDb21wb25lbnRTeXN0ZW1cbiAqL1xuY2xhc3MgU291bmRDb21wb25lbnRTeXN0ZW0gZXh0ZW5kcyBDb21wb25lbnRTeXN0ZW0ge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIFNvdW5kQ29tcG9uZW50U3lzdGVtLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtpbXBvcnQoJy4uLy4uL2FwcC1iYXNlLmpzJykuQXBwQmFzZX0gYXBwIC0gVGhlIEFwcGxpY2F0aW9uLlxuICAgICAqIEBoaWRlY29uc3RydWN0b3JcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihhcHApIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcblxuICAgICAgICB0aGlzLmlkID0gJ3NvdW5kJztcblxuICAgICAgICB0aGlzLkNvbXBvbmVudFR5cGUgPSBTb3VuZENvbXBvbmVudDtcbiAgICAgICAgdGhpcy5EYXRhVHlwZSA9IFNvdW5kQ29tcG9uZW50RGF0YTtcblxuICAgICAgICB0aGlzLnNjaGVtYSA9IF9zY2hlbWE7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEdldHMgLyBzZXRzIHRoZSBzb3VuZCBtYW5hZ2VyLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAdHlwZSB7aW1wb3J0KCcuLi8uLi8uLi9wbGF0Zm9ybS9zb3VuZC9tYW5hZ2VyLmpzJykuU291bmRNYW5hZ2VyfVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5tYW5hZ2VyID0gYXBwLnNvdW5kTWFuYWdlcjtcbiAgICAgICAgRGVidWcuYXNzZXJ0KHRoaXMubWFuYWdlciwgXCJBdWRpb1NvdXJjZUNvbXBvbmVudFN5c3RlbSBjYW5ub3QgYmUgY3JlYXRlZCB3aXRob3V0IHNvdW5kIG1hbmFnZXJcIik7XG5cbiAgICAgICAgdGhpcy5hcHAuc3lzdGVtcy5vbigndXBkYXRlJywgdGhpcy5vblVwZGF0ZSwgdGhpcyk7XG5cbiAgICAgICAgdGhpcy5vbignYmVmb3JlcmVtb3ZlJywgdGhpcy5vbkJlZm9yZVJlbW92ZSwgdGhpcyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0cyAvIGdldHMgdGhlIHZvbHVtZSBmb3IgdGhlIGVudGlyZSBTb3VuZCBzeXN0ZW0uIEFsbCBzb3VuZHMgd2lsbCBoYXZlIHRoZWlyIHZvbHVtZVxuICAgICAqIG11bHRpcGxpZWQgYnkgdGhpcyB2YWx1ZS4gVmFsaWQgYmV0d2VlbiBbMCwgMV0uXG4gICAgICpcbiAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAqL1xuICAgIHNldCB2b2x1bWUodm9sdW1lKSB7XG4gICAgICAgIHRoaXMubWFuYWdlci52b2x1bWUgPSB2b2x1bWU7XG4gICAgfVxuXG4gICAgZ2V0IHZvbHVtZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubWFuYWdlci52b2x1bWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgQXVkaW9Db250ZXh0IGN1cnJlbnRseSB1c2VkIGJ5IHRoZSBzb3VuZCBtYW5hZ2VyLiBSZXF1aXJlcyBXZWIgQXVkaW8gQVBJIHN1cHBvcnQuXG4gICAgICogUmV0dXJucyBudWxsIGlmIHRoZSBkZXZpY2UgZG9lcyBub3Qgc3VwcG9ydCB0aGUgV2ViIEF1ZGlvIEFQSS5cbiAgICAgKlxuICAgICAqIEB0eXBlIHtBdWRpb0NvbnRleHR8bnVsbH1cbiAgICAgKi9cbiAgICBnZXQgY29udGV4dCgpIHtcbiAgICAgICAgaWYgKCFoYXNBdWRpb0NvbnRleHQoKSkge1xuICAgICAgICAgICAgRGVidWcud2FybignV0FSTklORzogQXVkaW8gY29udGV4dCBpcyBub3Qgc3VwcG9ydGVkIG9uIHRoaXMgYnJvd3NlcicpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcy5tYW5hZ2VyLmNvbnRleHQ7XG4gICAgfVxuXG4gICAgaW5pdGlhbGl6ZUNvbXBvbmVudERhdGEoY29tcG9uZW50LCBkYXRhLCBwcm9wZXJ0aWVzKSB7XG4gICAgICAgIHByb3BlcnRpZXMgPSBbXG4gICAgICAgICAgICAndm9sdW1lJyxcbiAgICAgICAgICAgICdwaXRjaCcsXG4gICAgICAgICAgICAncG9zaXRpb25hbCcsXG4gICAgICAgICAgICAncmVmRGlzdGFuY2UnLFxuICAgICAgICAgICAgJ21heERpc3RhbmNlJyxcbiAgICAgICAgICAgICdyb2xsT2ZmRmFjdG9yJyxcbiAgICAgICAgICAgICdkaXN0YW5jZU1vZGVsJyxcbiAgICAgICAgICAgICdzbG90cydcbiAgICAgICAgXTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHByb3BlcnRpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChkYXRhLmhhc093blByb3BlcnR5KHByb3BlcnRpZXNbaV0pKSB7XG4gICAgICAgICAgICAgICAgY29tcG9uZW50W3Byb3BlcnRpZXNbaV1dID0gZGF0YVtwcm9wZXJ0aWVzW2ldXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHN1cGVyLmluaXRpYWxpemVDb21wb25lbnREYXRhKGNvbXBvbmVudCwgZGF0YSwgWydlbmFibGVkJ10pO1xuICAgIH1cblxuICAgIGNsb25lQ29tcG9uZW50KGVudGl0eSwgY2xvbmUpIHtcbiAgICAgICAgY29uc3Qgc3JjQ29tcG9uZW50ID0gZW50aXR5LnNvdW5kO1xuICAgICAgICBjb25zdCBzcmNTbG90cyA9IHNyY0NvbXBvbmVudC5zbG90cztcblxuICAgICAgICAvLyBjb252ZXJ0ICdzbG90cycgYmFjayB0b1xuICAgICAgICAvLyBzaW1wbGUgb3B0aW9uIG9iamVjdHNcbiAgICAgICAgY29uc3Qgc2xvdHMgPSB7fTtcbiAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gc3JjU2xvdHMpIHtcbiAgICAgICAgICAgIGNvbnN0IHNyY1Nsb3QgPSBzcmNTbG90c1trZXldO1xuICAgICAgICAgICAgc2xvdHNba2V5XSA9IHtcbiAgICAgICAgICAgICAgICBuYW1lOiBzcmNTbG90Lm5hbWUsXG4gICAgICAgICAgICAgICAgdm9sdW1lOiBzcmNTbG90LnZvbHVtZSxcbiAgICAgICAgICAgICAgICBwaXRjaDogc3JjU2xvdC5waXRjaCxcbiAgICAgICAgICAgICAgICBsb29wOiBzcmNTbG90Lmxvb3AsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IHNyY1Nsb3QuZHVyYXRpb24sXG4gICAgICAgICAgICAgICAgc3RhcnRUaW1lOiBzcmNTbG90LnN0YXJ0VGltZSxcbiAgICAgICAgICAgICAgICBvdmVybGFwOiBzcmNTbG90Lm92ZXJsYXAsXG4gICAgICAgICAgICAgICAgYXV0b1BsYXk6IHNyY1Nsb3QuYXV0b1BsYXksXG4gICAgICAgICAgICAgICAgYXNzZXQ6IHNyY1Nsb3QuYXNzZXRcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjbG9uZURhdGEgPSB7XG4gICAgICAgICAgICBkaXN0YW5jZU1vZGVsOiBzcmNDb21wb25lbnQuZGlzdGFuY2VNb2RlbCxcbiAgICAgICAgICAgIGVuYWJsZWQ6IHNyY0NvbXBvbmVudC5lbmFibGVkLFxuICAgICAgICAgICAgbWF4RGlzdGFuY2U6IHNyY0NvbXBvbmVudC5tYXhEaXN0YW5jZSxcbiAgICAgICAgICAgIHBpdGNoOiBzcmNDb21wb25lbnQucGl0Y2gsXG4gICAgICAgICAgICBwb3NpdGlvbmFsOiBzcmNDb21wb25lbnQucG9zaXRpb25hbCxcbiAgICAgICAgICAgIHJlZkRpc3RhbmNlOiBzcmNDb21wb25lbnQucmVmRGlzdGFuY2UsXG4gICAgICAgICAgICByb2xsT2ZmRmFjdG9yOiBzcmNDb21wb25lbnQucm9sbE9mZkZhY3RvcixcbiAgICAgICAgICAgIHNsb3RzOiBzbG90cyxcbiAgICAgICAgICAgIHZvbHVtZTogc3JjQ29tcG9uZW50LnZvbHVtZVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIGFkZCBjb21wb25lbnQgd2l0aCBuZXcgZGF0YVxuICAgICAgICByZXR1cm4gdGhpcy5hZGRDb21wb25lbnQoY2xvbmUsIGNsb25lRGF0YSk7XG4gICAgfVxuXG4gICAgb25VcGRhdGUoZHQpIHtcbiAgICAgICAgY29uc3Qgc3RvcmUgPSB0aGlzLnN0b3JlO1xuXG4gICAgICAgIGZvciAoY29uc3QgaWQgaW4gc3RvcmUpIHtcbiAgICAgICAgICAgIGlmIChzdG9yZS5oYXNPd25Qcm9wZXJ0eShpZCkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBpdGVtID0gc3RvcmVbaWRdO1xuICAgICAgICAgICAgICAgIGNvbnN0IGVudGl0eSA9IGl0ZW0uZW50aXR5O1xuXG4gICAgICAgICAgICAgICAgaWYgKGVudGl0eS5lbmFibGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbXBvbmVudCA9IGVudGl0eS5zb3VuZDtcblxuICAgICAgICAgICAgICAgICAgICAvLyBVcGRhdGUgc2xvdCBwb3NpdGlvbiBpZiB0aGlzIGlzIGEgM2Qgc291bmRcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbXBvbmVudC5lbmFibGVkICYmIGNvbXBvbmVudC5wb3NpdGlvbmFsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwb3NpdGlvbiA9IGVudGl0eS5nZXRQb3NpdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2xvdHMgPSBjb21wb25lbnQuc2xvdHM7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBzbG90cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNsb3RzW2tleV0udXBkYXRlUG9zaXRpb24ocG9zaXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgb25CZWZvcmVSZW1vdmUoZW50aXR5LCBjb21wb25lbnQpIHtcbiAgICAgICAgY29uc3Qgc2xvdHMgPSBjb21wb25lbnQuc2xvdHM7XG4gICAgICAgIC8vIHN0b3Agbm9uIG92ZXJsYXBwaW5nIHNvdW5kc1xuICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBzbG90cykge1xuICAgICAgICAgICAgaWYgKCFzbG90c1trZXldLm92ZXJsYXApIHtcbiAgICAgICAgICAgICAgICBzbG90c1trZXldLnN0b3AoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbXBvbmVudC5vblJlbW92ZSgpO1xuICAgIH1cblxuICAgIGRlc3Ryb3koKSB7XG4gICAgICAgIHN1cGVyLmRlc3Ryb3koKTtcblxuICAgICAgICB0aGlzLmFwcC5zeXN0ZW1zLm9mZigndXBkYXRlJywgdGhpcy5vblVwZGF0ZSwgdGhpcyk7XG4gICAgfVxufVxuXG5Db21wb25lbnQuX2J1aWxkQWNjZXNzb3JzKFNvdW5kQ29tcG9uZW50LnByb3RvdHlwZSwgX3NjaGVtYSk7XG5cbmV4cG9ydCB7IFNvdW5kQ29tcG9uZW50U3lzdGVtIH07XG4iXSwibmFtZXMiOlsiX3NjaGVtYSIsIlNvdW5kQ29tcG9uZW50U3lzdGVtIiwiQ29tcG9uZW50U3lzdGVtIiwiY29uc3RydWN0b3IiLCJhcHAiLCJpZCIsIkNvbXBvbmVudFR5cGUiLCJTb3VuZENvbXBvbmVudCIsIkRhdGFUeXBlIiwiU291bmRDb21wb25lbnREYXRhIiwic2NoZW1hIiwibWFuYWdlciIsInNvdW5kTWFuYWdlciIsIkRlYnVnIiwiYXNzZXJ0Iiwic3lzdGVtcyIsIm9uIiwib25VcGRhdGUiLCJvbkJlZm9yZVJlbW92ZSIsInZvbHVtZSIsImNvbnRleHQiLCJoYXNBdWRpb0NvbnRleHQiLCJ3YXJuIiwiaW5pdGlhbGl6ZUNvbXBvbmVudERhdGEiLCJjb21wb25lbnQiLCJkYXRhIiwicHJvcGVydGllcyIsImkiLCJsZW5ndGgiLCJoYXNPd25Qcm9wZXJ0eSIsImNsb25lQ29tcG9uZW50IiwiZW50aXR5IiwiY2xvbmUiLCJzcmNDb21wb25lbnQiLCJzb3VuZCIsInNyY1Nsb3RzIiwic2xvdHMiLCJrZXkiLCJzcmNTbG90IiwibmFtZSIsInBpdGNoIiwibG9vcCIsImR1cmF0aW9uIiwic3RhcnRUaW1lIiwib3ZlcmxhcCIsImF1dG9QbGF5IiwiYXNzZXQiLCJjbG9uZURhdGEiLCJkaXN0YW5jZU1vZGVsIiwiZW5hYmxlZCIsIm1heERpc3RhbmNlIiwicG9zaXRpb25hbCIsInJlZkRpc3RhbmNlIiwicm9sbE9mZkZhY3RvciIsImFkZENvbXBvbmVudCIsImR0Iiwic3RvcmUiLCJpdGVtIiwicG9zaXRpb24iLCJnZXRQb3NpdGlvbiIsInVwZGF0ZVBvc2l0aW9uIiwic3RvcCIsIm9uUmVtb3ZlIiwiZGVzdHJveSIsIm9mZiIsIkNvbXBvbmVudCIsIl9idWlsZEFjY2Vzc29ycyIsInByb3RvdHlwZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQVVBLE1BQU1BLE9BQU8sR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFBOztB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
