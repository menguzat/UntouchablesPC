import { extend } from '../../../core/core.js';
import { Vec3 } from '../../../core/math/vec3.js';
import { BoundingBox } from '../../../core/shape/bounding-box.js';
import { getDefaultMaterial } from '../../../scene/materials/default-material.js';
import { Asset } from '../../asset/asset.js';
import { Component } from '../component.js';
import { ComponentSystem } from '../system.js';
import { ModelComponent } from './component.js';
import { ModelComponentData } from './data.js';

const _schema = ['enabled'];

/**
 * Allows an Entity to render a model or a primitive shape like a box, capsule, sphere, cylinder,
 * cone etc.
 *
 * @augments ComponentSystem
 */
class ModelComponentSystem extends ComponentSystem {
  /**
   * Create a new ModelComponentSystem instance.
   *
   * @param {import('../../app-base.js').AppBase} app - The Application.
   * @hideconstructor
   */
  constructor(app) {
    super(app);
    this.id = 'model';
    this.ComponentType = ModelComponent;
    this.DataType = ModelComponentData;
    this.schema = _schema;
    this.defaultMaterial = getDefaultMaterial(app.graphicsDevice);
    this.on('beforeremove', this.onRemove, this);
  }
  initializeComponentData(component, _data, properties) {
    // order matters here
    properties = ['material', 'materialAsset', 'asset', 'castShadows', 'receiveShadows', 'castShadowsLightmap', 'lightmapped', 'lightmapSizeMultiplier', 'type', 'mapping', 'layers', 'isStatic', 'batchGroupId'];
    if (_data.batchGroupId === null || _data.batchGroupId === undefined) {
      _data.batchGroupId = -1;
    }

    // duplicate layer list
    if (_data.layers && _data.layers.length) {
      _data.layers = _data.layers.slice(0);
    }
    for (let i = 0; i < properties.length; i++) {
      if (_data.hasOwnProperty(properties[i])) {
        component[properties[i]] = _data[properties[i]];
      }
    }
    if (_data.aabbCenter && _data.aabbHalfExtents) {
      component.customAabb = new BoundingBox(new Vec3(_data.aabbCenter), new Vec3(_data.aabbHalfExtents));
    }
    super.initializeComponentData(component, _data, ['enabled']);
  }
  cloneComponent(entity, clone) {
    const data = {
      type: entity.model.type,
      asset: entity.model.asset,
      castShadows: entity.model.castShadows,
      receiveShadows: entity.model.receiveShadows,
      castShadowsLightmap: entity.model.castShadowsLightmap,
      lightmapped: entity.model.lightmapped,
      lightmapSizeMultiplier: entity.model.lightmapSizeMultiplier,
      isStatic: entity.model.isStatic,
      enabled: entity.model.enabled,
      layers: entity.model.layers,
      batchGroupId: entity.model.batchGroupId,
      mapping: extend({}, entity.model.mapping)
    };

    // if original has a different material
    // than the assigned materialAsset then make sure we
    // clone that one instead of the materialAsset one
    let materialAsset = entity.model.materialAsset;
    if (!(materialAsset instanceof Asset) && materialAsset != null) {
      materialAsset = this.app.assets.get(materialAsset);
    }
    const material = entity.model.material;
    if (!material || material === this.defaultMaterial || !materialAsset || material === materialAsset.resource) {
      data.materialAsset = materialAsset;
    }
    const component = this.addComponent(clone, data);

    // clone the original model if the original model component is of type asset but
    // has no specified asset
    if (entity.model.model && entity.model.type === 'asset' && !entity.model.asset) {
      component.model = entity.model.model.clone();
      component._clonedModel = true;
    }
    if (!data.materialAsset) component.material = material;

    // TODO: we should copy all relevant mesh instance properties here
    if (entity.model.model) {
      const meshInstances = entity.model.model.meshInstances;
      const meshInstancesClone = component.model.meshInstances;
      for (let i = 0; i < meshInstances.length; i++) {
        meshInstancesClone[i].mask = meshInstances[i].mask;
        meshInstancesClone[i].material = meshInstances[i].material;
        meshInstancesClone[i].layer = meshInstances[i].layer;
        meshInstancesClone[i].receiveShadow = meshInstances[i].receiveShadow;
      }
    }
    if (entity.model.customAabb) {
      component.customAabb = entity.model.customAabb.clone();
    }
    return component;
  }
  onRemove(entity, component) {
    component.onRemove();
  }
}
Component._buildAccessors(ModelComponent.prototype, _schema);

export { ModelComponentSystem };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3lzdGVtLmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvZnJhbWV3b3JrL2NvbXBvbmVudHMvbW9kZWwvc3lzdGVtLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGV4dGVuZCB9IGZyb20gJy4uLy4uLy4uL2NvcmUvY29yZS5qcyc7XG5cbmltcG9ydCB7IFZlYzMgfSBmcm9tICcuLi8uLi8uLi9jb3JlL21hdGgvdmVjMy5qcyc7XG5cbmltcG9ydCB7IEJvdW5kaW5nQm94IH0gZnJvbSAnLi4vLi4vLi4vY29yZS9zaGFwZS9ib3VuZGluZy1ib3guanMnO1xuXG5pbXBvcnQgeyBnZXREZWZhdWx0TWF0ZXJpYWwgfSBmcm9tICcuLi8uLi8uLi9zY2VuZS9tYXRlcmlhbHMvZGVmYXVsdC1tYXRlcmlhbC5qcyc7XG5cbmltcG9ydCB7IEFzc2V0IH0gZnJvbSAnLi4vLi4vYXNzZXQvYXNzZXQuanMnO1xuXG5pbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tICcuLi9jb21wb25lbnQuanMnO1xuaW1wb3J0IHsgQ29tcG9uZW50U3lzdGVtIH0gZnJvbSAnLi4vc3lzdGVtLmpzJztcblxuaW1wb3J0IHsgTW9kZWxDb21wb25lbnQgfSBmcm9tICcuL2NvbXBvbmVudC5qcyc7XG5pbXBvcnQgeyBNb2RlbENvbXBvbmVudERhdGEgfSBmcm9tICcuL2RhdGEuanMnO1xuXG5jb25zdCBfc2NoZW1hID0gWydlbmFibGVkJ107XG5cbi8qKlxuICogQWxsb3dzIGFuIEVudGl0eSB0byByZW5kZXIgYSBtb2RlbCBvciBhIHByaW1pdGl2ZSBzaGFwZSBsaWtlIGEgYm94LCBjYXBzdWxlLCBzcGhlcmUsIGN5bGluZGVyLFxuICogY29uZSBldGMuXG4gKlxuICogQGF1Z21lbnRzIENvbXBvbmVudFN5c3RlbVxuICovXG5jbGFzcyBNb2RlbENvbXBvbmVudFN5c3RlbSBleHRlbmRzIENvbXBvbmVudFN5c3RlbSB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgbmV3IE1vZGVsQ29tcG9uZW50U3lzdGVtIGluc3RhbmNlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtpbXBvcnQoJy4uLy4uL2FwcC1iYXNlLmpzJykuQXBwQmFzZX0gYXBwIC0gVGhlIEFwcGxpY2F0aW9uLlxuICAgICAqIEBoaWRlY29uc3RydWN0b3JcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihhcHApIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcblxuICAgICAgICB0aGlzLmlkID0gJ21vZGVsJztcblxuICAgICAgICB0aGlzLkNvbXBvbmVudFR5cGUgPSBNb2RlbENvbXBvbmVudDtcbiAgICAgICAgdGhpcy5EYXRhVHlwZSA9IE1vZGVsQ29tcG9uZW50RGF0YTtcblxuICAgICAgICB0aGlzLnNjaGVtYSA9IF9zY2hlbWE7XG4gICAgICAgIHRoaXMuZGVmYXVsdE1hdGVyaWFsID0gZ2V0RGVmYXVsdE1hdGVyaWFsKGFwcC5ncmFwaGljc0RldmljZSk7XG5cbiAgICAgICAgdGhpcy5vbignYmVmb3JlcmVtb3ZlJywgdGhpcy5vblJlbW92ZSwgdGhpcyk7XG4gICAgfVxuXG4gICAgaW5pdGlhbGl6ZUNvbXBvbmVudERhdGEoY29tcG9uZW50LCBfZGF0YSwgcHJvcGVydGllcykge1xuICAgICAgICAvLyBvcmRlciBtYXR0ZXJzIGhlcmVcbiAgICAgICAgcHJvcGVydGllcyA9IFtcbiAgICAgICAgICAgICdtYXRlcmlhbCcsXG4gICAgICAgICAgICAnbWF0ZXJpYWxBc3NldCcsXG4gICAgICAgICAgICAnYXNzZXQnLFxuICAgICAgICAgICAgJ2Nhc3RTaGFkb3dzJyxcbiAgICAgICAgICAgICdyZWNlaXZlU2hhZG93cycsXG4gICAgICAgICAgICAnY2FzdFNoYWRvd3NMaWdodG1hcCcsXG4gICAgICAgICAgICAnbGlnaHRtYXBwZWQnLFxuICAgICAgICAgICAgJ2xpZ2h0bWFwU2l6ZU11bHRpcGxpZXInLFxuICAgICAgICAgICAgJ3R5cGUnLFxuICAgICAgICAgICAgJ21hcHBpbmcnLFxuICAgICAgICAgICAgJ2xheWVycycsXG4gICAgICAgICAgICAnaXNTdGF0aWMnLFxuICAgICAgICAgICAgJ2JhdGNoR3JvdXBJZCdcbiAgICAgICAgXTtcblxuICAgICAgICBpZiAoX2RhdGEuYmF0Y2hHcm91cElkID09PSBudWxsIHx8IF9kYXRhLmJhdGNoR3JvdXBJZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBfZGF0YS5iYXRjaEdyb3VwSWQgPSAtMTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGR1cGxpY2F0ZSBsYXllciBsaXN0XG4gICAgICAgIGlmIChfZGF0YS5sYXllcnMgJiYgX2RhdGEubGF5ZXJzLmxlbmd0aCkge1xuICAgICAgICAgICAgX2RhdGEubGF5ZXJzID0gX2RhdGEubGF5ZXJzLnNsaWNlKDApO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwcm9wZXJ0aWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoX2RhdGEuaGFzT3duUHJvcGVydHkocHJvcGVydGllc1tpXSkpIHtcbiAgICAgICAgICAgICAgICBjb21wb25lbnRbcHJvcGVydGllc1tpXV0gPSBfZGF0YVtwcm9wZXJ0aWVzW2ldXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChfZGF0YS5hYWJiQ2VudGVyICYmIF9kYXRhLmFhYmJIYWxmRXh0ZW50cykge1xuICAgICAgICAgICAgY29tcG9uZW50LmN1c3RvbUFhYmIgPSBuZXcgQm91bmRpbmdCb3gobmV3IFZlYzMoX2RhdGEuYWFiYkNlbnRlciksIG5ldyBWZWMzKF9kYXRhLmFhYmJIYWxmRXh0ZW50cykpO1xuICAgICAgICB9XG5cbiAgICAgICAgc3VwZXIuaW5pdGlhbGl6ZUNvbXBvbmVudERhdGEoY29tcG9uZW50LCBfZGF0YSwgWydlbmFibGVkJ10pO1xuICAgIH1cblxuICAgIGNsb25lQ29tcG9uZW50KGVudGl0eSwgY2xvbmUpIHtcbiAgICAgICAgY29uc3QgZGF0YSA9IHtcbiAgICAgICAgICAgIHR5cGU6IGVudGl0eS5tb2RlbC50eXBlLFxuICAgICAgICAgICAgYXNzZXQ6IGVudGl0eS5tb2RlbC5hc3NldCxcbiAgICAgICAgICAgIGNhc3RTaGFkb3dzOiBlbnRpdHkubW9kZWwuY2FzdFNoYWRvd3MsXG4gICAgICAgICAgICByZWNlaXZlU2hhZG93czogZW50aXR5Lm1vZGVsLnJlY2VpdmVTaGFkb3dzLFxuICAgICAgICAgICAgY2FzdFNoYWRvd3NMaWdodG1hcDogZW50aXR5Lm1vZGVsLmNhc3RTaGFkb3dzTGlnaHRtYXAsXG4gICAgICAgICAgICBsaWdodG1hcHBlZDogZW50aXR5Lm1vZGVsLmxpZ2h0bWFwcGVkLFxuICAgICAgICAgICAgbGlnaHRtYXBTaXplTXVsdGlwbGllcjogZW50aXR5Lm1vZGVsLmxpZ2h0bWFwU2l6ZU11bHRpcGxpZXIsXG4gICAgICAgICAgICBpc1N0YXRpYzogZW50aXR5Lm1vZGVsLmlzU3RhdGljLFxuICAgICAgICAgICAgZW5hYmxlZDogZW50aXR5Lm1vZGVsLmVuYWJsZWQsXG4gICAgICAgICAgICBsYXllcnM6IGVudGl0eS5tb2RlbC5sYXllcnMsXG4gICAgICAgICAgICBiYXRjaEdyb3VwSWQ6IGVudGl0eS5tb2RlbC5iYXRjaEdyb3VwSWQsXG4gICAgICAgICAgICBtYXBwaW5nOiBleHRlbmQoe30sIGVudGl0eS5tb2RlbC5tYXBwaW5nKVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIGlmIG9yaWdpbmFsIGhhcyBhIGRpZmZlcmVudCBtYXRlcmlhbFxuICAgICAgICAvLyB0aGFuIHRoZSBhc3NpZ25lZCBtYXRlcmlhbEFzc2V0IHRoZW4gbWFrZSBzdXJlIHdlXG4gICAgICAgIC8vIGNsb25lIHRoYXQgb25lIGluc3RlYWQgb2YgdGhlIG1hdGVyaWFsQXNzZXQgb25lXG4gICAgICAgIGxldCBtYXRlcmlhbEFzc2V0ID0gZW50aXR5Lm1vZGVsLm1hdGVyaWFsQXNzZXQ7XG4gICAgICAgIGlmICghKG1hdGVyaWFsQXNzZXQgaW5zdGFuY2VvZiBBc3NldCkgJiYgbWF0ZXJpYWxBc3NldCAhPSBudWxsKSB7XG4gICAgICAgICAgICBtYXRlcmlhbEFzc2V0ID0gdGhpcy5hcHAuYXNzZXRzLmdldChtYXRlcmlhbEFzc2V0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IG1hdGVyaWFsID0gZW50aXR5Lm1vZGVsLm1hdGVyaWFsO1xuICAgICAgICBpZiAoIW1hdGVyaWFsIHx8XG4gICAgICAgICAgICBtYXRlcmlhbCA9PT0gdGhpcy5kZWZhdWx0TWF0ZXJpYWwgfHxcbiAgICAgICAgICAgICFtYXRlcmlhbEFzc2V0IHx8XG4gICAgICAgICAgICBtYXRlcmlhbCA9PT0gbWF0ZXJpYWxBc3NldC5yZXNvdXJjZSkge1xuXG4gICAgICAgICAgICBkYXRhLm1hdGVyaWFsQXNzZXQgPSBtYXRlcmlhbEFzc2V0O1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY29tcG9uZW50ID0gdGhpcy5hZGRDb21wb25lbnQoY2xvbmUsIGRhdGEpO1xuXG4gICAgICAgIC8vIGNsb25lIHRoZSBvcmlnaW5hbCBtb2RlbCBpZiB0aGUgb3JpZ2luYWwgbW9kZWwgY29tcG9uZW50IGlzIG9mIHR5cGUgYXNzZXQgYnV0XG4gICAgICAgIC8vIGhhcyBubyBzcGVjaWZpZWQgYXNzZXRcbiAgICAgICAgaWYgKGVudGl0eS5tb2RlbC5tb2RlbCAmJiBlbnRpdHkubW9kZWwudHlwZSA9PT0gJ2Fzc2V0JyAmJiAhZW50aXR5Lm1vZGVsLmFzc2V0KSB7XG4gICAgICAgICAgICBjb21wb25lbnQubW9kZWwgPSBlbnRpdHkubW9kZWwubW9kZWwuY2xvbmUoKTtcbiAgICAgICAgICAgIGNvbXBvbmVudC5fY2xvbmVkTW9kZWwgPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFkYXRhLm1hdGVyaWFsQXNzZXQpXG4gICAgICAgICAgICBjb21wb25lbnQubWF0ZXJpYWwgPSBtYXRlcmlhbDtcblxuICAgICAgICAvLyBUT0RPOiB3ZSBzaG91bGQgY29weSBhbGwgcmVsZXZhbnQgbWVzaCBpbnN0YW5jZSBwcm9wZXJ0aWVzIGhlcmVcbiAgICAgICAgaWYgKGVudGl0eS5tb2RlbC5tb2RlbCkge1xuICAgICAgICAgICAgY29uc3QgbWVzaEluc3RhbmNlcyA9IGVudGl0eS5tb2RlbC5tb2RlbC5tZXNoSW5zdGFuY2VzO1xuICAgICAgICAgICAgY29uc3QgbWVzaEluc3RhbmNlc0Nsb25lID0gY29tcG9uZW50Lm1vZGVsLm1lc2hJbnN0YW5jZXM7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1lc2hJbnN0YW5jZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBtZXNoSW5zdGFuY2VzQ2xvbmVbaV0ubWFzayA9IG1lc2hJbnN0YW5jZXNbaV0ubWFzaztcbiAgICAgICAgICAgICAgICBtZXNoSW5zdGFuY2VzQ2xvbmVbaV0ubWF0ZXJpYWwgPSBtZXNoSW5zdGFuY2VzW2ldLm1hdGVyaWFsO1xuICAgICAgICAgICAgICAgIG1lc2hJbnN0YW5jZXNDbG9uZVtpXS5sYXllciA9IG1lc2hJbnN0YW5jZXNbaV0ubGF5ZXI7XG4gICAgICAgICAgICAgICAgbWVzaEluc3RhbmNlc0Nsb25lW2ldLnJlY2VpdmVTaGFkb3cgPSBtZXNoSW5zdGFuY2VzW2ldLnJlY2VpdmVTaGFkb3c7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZW50aXR5Lm1vZGVsLmN1c3RvbUFhYmIpIHtcbiAgICAgICAgICAgIGNvbXBvbmVudC5jdXN0b21BYWJiID0gZW50aXR5Lm1vZGVsLmN1c3RvbUFhYmIuY2xvbmUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBjb21wb25lbnQ7XG4gICAgfVxuXG4gICAgb25SZW1vdmUoZW50aXR5LCBjb21wb25lbnQpIHtcbiAgICAgICAgY29tcG9uZW50Lm9uUmVtb3ZlKCk7XG4gICAgfVxufVxuXG5Db21wb25lbnQuX2J1aWxkQWNjZXNzb3JzKE1vZGVsQ29tcG9uZW50LnByb3RvdHlwZSwgX3NjaGVtYSk7XG5cbmV4cG9ydCB7IE1vZGVsQ29tcG9uZW50U3lzdGVtIH07XG4iXSwibmFtZXMiOlsiX3NjaGVtYSIsIk1vZGVsQ29tcG9uZW50U3lzdGVtIiwiQ29tcG9uZW50U3lzdGVtIiwiY29uc3RydWN0b3IiLCJhcHAiLCJpZCIsIkNvbXBvbmVudFR5cGUiLCJNb2RlbENvbXBvbmVudCIsIkRhdGFUeXBlIiwiTW9kZWxDb21wb25lbnREYXRhIiwic2NoZW1hIiwiZGVmYXVsdE1hdGVyaWFsIiwiZ2V0RGVmYXVsdE1hdGVyaWFsIiwiZ3JhcGhpY3NEZXZpY2UiLCJvbiIsIm9uUmVtb3ZlIiwiaW5pdGlhbGl6ZUNvbXBvbmVudERhdGEiLCJjb21wb25lbnQiLCJfZGF0YSIsInByb3BlcnRpZXMiLCJiYXRjaEdyb3VwSWQiLCJ1bmRlZmluZWQiLCJsYXllcnMiLCJsZW5ndGgiLCJzbGljZSIsImkiLCJoYXNPd25Qcm9wZXJ0eSIsImFhYmJDZW50ZXIiLCJhYWJiSGFsZkV4dGVudHMiLCJjdXN0b21BYWJiIiwiQm91bmRpbmdCb3giLCJWZWMzIiwiY2xvbmVDb21wb25lbnQiLCJlbnRpdHkiLCJjbG9uZSIsImRhdGEiLCJ0eXBlIiwibW9kZWwiLCJhc3NldCIsImNhc3RTaGFkb3dzIiwicmVjZWl2ZVNoYWRvd3MiLCJjYXN0U2hhZG93c0xpZ2h0bWFwIiwibGlnaHRtYXBwZWQiLCJsaWdodG1hcFNpemVNdWx0aXBsaWVyIiwiaXNTdGF0aWMiLCJlbmFibGVkIiwibWFwcGluZyIsImV4dGVuZCIsIm1hdGVyaWFsQXNzZXQiLCJBc3NldCIsImFzc2V0cyIsImdldCIsIm1hdGVyaWFsIiwicmVzb3VyY2UiLCJhZGRDb21wb25lbnQiLCJfY2xvbmVkTW9kZWwiLCJtZXNoSW5zdGFuY2VzIiwibWVzaEluc3RhbmNlc0Nsb25lIiwibWFzayIsImxheWVyIiwicmVjZWl2ZVNoYWRvdyIsIkNvbXBvbmVudCIsIl9idWlsZEFjY2Vzc29ycyIsInByb3RvdHlwZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQWdCQSxNQUFNQSxP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
