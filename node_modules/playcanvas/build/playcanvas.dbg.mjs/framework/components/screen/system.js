import { IndexedList } from '../../../core/indexed-list.js';
import { Vec2 } from '../../../core/math/vec2.js';
import { Component } from '../component.js';
import { ComponentSystem } from '../system.js';
import { ScreenComponent } from './component.js';
import { ScreenComponentData } from './data.js';

const _schema = ['enabled'];

/**
 * Manages creation of {@link ScreenComponent}s.
 *
 * @augments ComponentSystem
 */
class ScreenComponentSystem extends ComponentSystem {
  /**
   * Create a new ScreenComponentSystem instance.
   *
   * @param {import('../../app-base.js').AppBase} app - The application.
   * @hideconstructor
   */
  constructor(app) {
    super(app);
    this.id = 'screen';
    this.ComponentType = ScreenComponent;
    this.DataType = ScreenComponentData;
    this.schema = _schema;
    this.windowResolution = new Vec2();

    // queue of callbacks
    this._drawOrderSyncQueue = new IndexedList();
    this.app.graphicsDevice.on('resizecanvas', this._onResize, this);
    this.app.systems.on('update', this._onUpdate, this);
    this.on('beforeremove', this.onRemoveComponent, this);
  }
  initializeComponentData(component, data, properties) {
    if (data.priority !== undefined) component.priority = data.priority;
    if (data.screenSpace !== undefined) component.screenSpace = data.screenSpace;
    component.cull = component.screenSpace;
    if (data.scaleMode !== undefined) component.scaleMode = data.scaleMode;
    if (data.scaleBlend !== undefined) component.scaleBlend = data.scaleBlend;
    if (data.resolution !== undefined) {
      if (data.resolution instanceof Vec2) {
        component._resolution.copy(data.resolution);
      } else {
        component._resolution.set(data.resolution[0], data.resolution[1]);
      }
      component.resolution = component._resolution;
    }
    if (data.referenceResolution !== undefined) {
      if (data.referenceResolution instanceof Vec2) {
        component._referenceResolution.copy(data.referenceResolution);
      } else {
        component._referenceResolution.set(data.referenceResolution[0], data.referenceResolution[1]);
      }
      component.referenceResolution = component._referenceResolution;
    }

    // queue up a draw order sync
    component.syncDrawOrder();
    super.initializeComponentData(component, data, properties);
  }
  destroy() {
    super.destroy();
    this.app.graphicsDevice.off('resizecanvas', this._onResize, this);
    this.app.systems.off('update', this._onUpdate, this);
  }
  _onUpdate(dt) {
    const components = this.store;
    for (const id in components) {
      if (components[id].entity.screen.update) components[id].entity.screen.update(dt);
    }
  }
  _onResize(width, height) {
    this.windowResolution.x = width;
    this.windowResolution.y = height;
  }
  cloneComponent(entity, clone) {
    const screen = entity.screen;
    return this.addComponent(clone, {
      enabled: screen.enabled,
      screenSpace: screen.screenSpace,
      scaleMode: screen.scaleMode,
      resolution: screen.resolution.clone(),
      referenceResolution: screen.referenceResolution.clone()
    });
  }
  onRemoveComponent(entity, component) {
    component.onRemove();
  }
  processDrawOrderSyncQueue() {
    const list = this._drawOrderSyncQueue.list();
    for (let i = 0; i < list.length; i++) {
      const item = list[i];
      item.callback.call(item.scope);
    }
    this._drawOrderSyncQueue.clear();
  }
  queueDrawOrderSync(id, fn, scope) {
    // first queued sync this frame
    // attach an event listener
    if (!this._drawOrderSyncQueue.list().length) {
      this.app.once('prerender', this.processDrawOrderSyncQueue, this);
    }
    if (!this._drawOrderSyncQueue.has(id)) {
      this._drawOrderSyncQueue.push(id, {
        callback: fn,
        scope: scope
      });
    }
  }
}
Component._buildAccessors(ScreenComponent.prototype, _schema);

export { ScreenComponentSystem };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3lzdGVtLmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvZnJhbWV3b3JrL2NvbXBvbmVudHMvc2NyZWVuL3N5c3RlbS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmRleGVkTGlzdCB9IGZyb20gJy4uLy4uLy4uL2NvcmUvaW5kZXhlZC1saXN0LmpzJztcblxuaW1wb3J0IHsgVmVjMiB9IGZyb20gJy4uLy4uLy4uL2NvcmUvbWF0aC92ZWMyLmpzJztcblxuaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSAnLi4vY29tcG9uZW50LmpzJztcbmltcG9ydCB7IENvbXBvbmVudFN5c3RlbSB9IGZyb20gJy4uL3N5c3RlbS5qcyc7XG5cbmltcG9ydCB7IFNjcmVlbkNvbXBvbmVudCB9IGZyb20gJy4vY29tcG9uZW50LmpzJztcbmltcG9ydCB7IFNjcmVlbkNvbXBvbmVudERhdGEgfSBmcm9tICcuL2RhdGEuanMnO1xuXG5jb25zdCBfc2NoZW1hID0gWydlbmFibGVkJ107XG5cbi8qKlxuICogTWFuYWdlcyBjcmVhdGlvbiBvZiB7QGxpbmsgU2NyZWVuQ29tcG9uZW50fXMuXG4gKlxuICogQGF1Z21lbnRzIENvbXBvbmVudFN5c3RlbVxuICovXG5jbGFzcyBTY3JlZW5Db21wb25lbnRTeXN0ZW0gZXh0ZW5kcyBDb21wb25lbnRTeXN0ZW0ge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIG5ldyBTY3JlZW5Db21wb25lbnRTeXN0ZW0gaW5zdGFuY2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2ltcG9ydCgnLi4vLi4vYXBwLWJhc2UuanMnKS5BcHBCYXNlfSBhcHAgLSBUaGUgYXBwbGljYXRpb24uXG4gICAgICogQGhpZGVjb25zdHJ1Y3RvclxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGFwcCkge1xuICAgICAgICBzdXBlcihhcHApO1xuXG4gICAgICAgIHRoaXMuaWQgPSAnc2NyZWVuJztcblxuICAgICAgICB0aGlzLkNvbXBvbmVudFR5cGUgPSBTY3JlZW5Db21wb25lbnQ7XG4gICAgICAgIHRoaXMuRGF0YVR5cGUgPSBTY3JlZW5Db21wb25lbnREYXRhO1xuXG4gICAgICAgIHRoaXMuc2NoZW1hID0gX3NjaGVtYTtcblxuICAgICAgICB0aGlzLndpbmRvd1Jlc29sdXRpb24gPSBuZXcgVmVjMigpO1xuXG4gICAgICAgIC8vIHF1ZXVlIG9mIGNhbGxiYWNrc1xuICAgICAgICB0aGlzLl9kcmF3T3JkZXJTeW5jUXVldWUgPSBuZXcgSW5kZXhlZExpc3QoKTtcblxuICAgICAgICB0aGlzLmFwcC5ncmFwaGljc0RldmljZS5vbigncmVzaXplY2FudmFzJywgdGhpcy5fb25SZXNpemUsIHRoaXMpO1xuXG4gICAgICAgIHRoaXMuYXBwLnN5c3RlbXMub24oJ3VwZGF0ZScsIHRoaXMuX29uVXBkYXRlLCB0aGlzKTtcblxuICAgICAgICB0aGlzLm9uKCdiZWZvcmVyZW1vdmUnLCB0aGlzLm9uUmVtb3ZlQ29tcG9uZW50LCB0aGlzKTtcbiAgICB9XG5cbiAgICBpbml0aWFsaXplQ29tcG9uZW50RGF0YShjb21wb25lbnQsIGRhdGEsIHByb3BlcnRpZXMpIHtcbiAgICAgICAgaWYgKGRhdGEucHJpb3JpdHkgIT09IHVuZGVmaW5lZCkgY29tcG9uZW50LnByaW9yaXR5ID0gZGF0YS5wcmlvcml0eTtcbiAgICAgICAgaWYgKGRhdGEuc2NyZWVuU3BhY2UgIT09IHVuZGVmaW5lZCkgY29tcG9uZW50LnNjcmVlblNwYWNlID0gZGF0YS5zY3JlZW5TcGFjZTtcbiAgICAgICAgY29tcG9uZW50LmN1bGwgPSBjb21wb25lbnQuc2NyZWVuU3BhY2U7XG4gICAgICAgIGlmIChkYXRhLnNjYWxlTW9kZSAhPT0gdW5kZWZpbmVkKSBjb21wb25lbnQuc2NhbGVNb2RlID0gZGF0YS5zY2FsZU1vZGU7XG4gICAgICAgIGlmIChkYXRhLnNjYWxlQmxlbmQgIT09IHVuZGVmaW5lZCkgY29tcG9uZW50LnNjYWxlQmxlbmQgPSBkYXRhLnNjYWxlQmxlbmQ7XG4gICAgICAgIGlmIChkYXRhLnJlc29sdXRpb24gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgaWYgKGRhdGEucmVzb2x1dGlvbiBpbnN0YW5jZW9mIFZlYzIpIHtcbiAgICAgICAgICAgICAgICBjb21wb25lbnQuX3Jlc29sdXRpb24uY29weShkYXRhLnJlc29sdXRpb24pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb21wb25lbnQuX3Jlc29sdXRpb24uc2V0KGRhdGEucmVzb2x1dGlvblswXSwgZGF0YS5yZXNvbHV0aW9uWzFdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbXBvbmVudC5yZXNvbHV0aW9uID0gY29tcG9uZW50Ll9yZXNvbHV0aW9uO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkYXRhLnJlZmVyZW5jZVJlc29sdXRpb24gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgaWYgKGRhdGEucmVmZXJlbmNlUmVzb2x1dGlvbiBpbnN0YW5jZW9mIFZlYzIpIHtcbiAgICAgICAgICAgICAgICBjb21wb25lbnQuX3JlZmVyZW5jZVJlc29sdXRpb24uY29weShkYXRhLnJlZmVyZW5jZVJlc29sdXRpb24pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb21wb25lbnQuX3JlZmVyZW5jZVJlc29sdXRpb24uc2V0KGRhdGEucmVmZXJlbmNlUmVzb2x1dGlvblswXSwgZGF0YS5yZWZlcmVuY2VSZXNvbHV0aW9uWzFdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbXBvbmVudC5yZWZlcmVuY2VSZXNvbHV0aW9uID0gY29tcG9uZW50Ll9yZWZlcmVuY2VSZXNvbHV0aW9uO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gcXVldWUgdXAgYSBkcmF3IG9yZGVyIHN5bmNcbiAgICAgICAgY29tcG9uZW50LnN5bmNEcmF3T3JkZXIoKTtcbiAgICAgICAgc3VwZXIuaW5pdGlhbGl6ZUNvbXBvbmVudERhdGEoY29tcG9uZW50LCBkYXRhLCBwcm9wZXJ0aWVzKTtcbiAgICB9XG5cbiAgICBkZXN0cm95KCkge1xuICAgICAgICBzdXBlci5kZXN0cm95KCk7XG5cbiAgICAgICAgdGhpcy5hcHAuZ3JhcGhpY3NEZXZpY2Uub2ZmKCdyZXNpemVjYW52YXMnLCB0aGlzLl9vblJlc2l6ZSwgdGhpcyk7XG4gICAgICAgIHRoaXMuYXBwLnN5c3RlbXMub2ZmKCd1cGRhdGUnLCB0aGlzLl9vblVwZGF0ZSwgdGhpcyk7XG4gICAgfVxuXG4gICAgX29uVXBkYXRlKGR0KSB7XG4gICAgICAgIGNvbnN0IGNvbXBvbmVudHMgPSB0aGlzLnN0b3JlO1xuXG4gICAgICAgIGZvciAoY29uc3QgaWQgaW4gY29tcG9uZW50cykge1xuICAgICAgICAgICAgaWYgKGNvbXBvbmVudHNbaWRdLmVudGl0eS5zY3JlZW4udXBkYXRlKSBjb21wb25lbnRzW2lkXS5lbnRpdHkuc2NyZWVuLnVwZGF0ZShkdCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfb25SZXNpemUod2lkdGgsIGhlaWdodCkge1xuICAgICAgICB0aGlzLndpbmRvd1Jlc29sdXRpb24ueCA9IHdpZHRoO1xuICAgICAgICB0aGlzLndpbmRvd1Jlc29sdXRpb24ueSA9IGhlaWdodDtcbiAgICB9XG5cbiAgICBjbG9uZUNvbXBvbmVudChlbnRpdHksIGNsb25lKSB7XG4gICAgICAgIGNvbnN0IHNjcmVlbiA9IGVudGl0eS5zY3JlZW47XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuYWRkQ29tcG9uZW50KGNsb25lLCB7XG4gICAgICAgICAgICBlbmFibGVkOiBzY3JlZW4uZW5hYmxlZCxcbiAgICAgICAgICAgIHNjcmVlblNwYWNlOiBzY3JlZW4uc2NyZWVuU3BhY2UsXG4gICAgICAgICAgICBzY2FsZU1vZGU6IHNjcmVlbi5zY2FsZU1vZGUsXG4gICAgICAgICAgICByZXNvbHV0aW9uOiBzY3JlZW4ucmVzb2x1dGlvbi5jbG9uZSgpLFxuICAgICAgICAgICAgcmVmZXJlbmNlUmVzb2x1dGlvbjogc2NyZWVuLnJlZmVyZW5jZVJlc29sdXRpb24uY2xvbmUoKVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBvblJlbW92ZUNvbXBvbmVudChlbnRpdHksIGNvbXBvbmVudCkge1xuICAgICAgICBjb21wb25lbnQub25SZW1vdmUoKTtcbiAgICB9XG5cbiAgICBwcm9jZXNzRHJhd09yZGVyU3luY1F1ZXVlKCkge1xuICAgICAgICBjb25zdCBsaXN0ID0gdGhpcy5fZHJhd09yZGVyU3luY1F1ZXVlLmxpc3QoKTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSBsaXN0W2ldO1xuICAgICAgICAgICAgaXRlbS5jYWxsYmFjay5jYWxsKGl0ZW0uc2NvcGUpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2RyYXdPcmRlclN5bmNRdWV1ZS5jbGVhcigpO1xuICAgIH1cblxuICAgIHF1ZXVlRHJhd09yZGVyU3luYyhpZCwgZm4sIHNjb3BlKSB7XG4gICAgICAgIC8vIGZpcnN0IHF1ZXVlZCBzeW5jIHRoaXMgZnJhbWVcbiAgICAgICAgLy8gYXR0YWNoIGFuIGV2ZW50IGxpc3RlbmVyXG4gICAgICAgIGlmICghdGhpcy5fZHJhd09yZGVyU3luY1F1ZXVlLmxpc3QoKS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMuYXBwLm9uY2UoJ3ByZXJlbmRlcicsIHRoaXMucHJvY2Vzc0RyYXdPcmRlclN5bmNRdWV1ZSwgdGhpcyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXRoaXMuX2RyYXdPcmRlclN5bmNRdWV1ZS5oYXMoaWQpKSB7XG4gICAgICAgICAgICB0aGlzLl9kcmF3T3JkZXJTeW5jUXVldWUucHVzaChpZCwge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmbixcbiAgICAgICAgICAgICAgICBzY29wZTogc2NvcGVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5Db21wb25lbnQuX2J1aWxkQWNjZXNzb3JzKFNjcmVlbkNvbXBvbmVudC5wcm90b3R5cGUsIF9zY2hlbWEpO1xuXG5leHBvcnQgeyBTY3JlZW5Db21wb25lbnRTeXN0ZW0gfTtcbiJdLCJuYW1lcyI6WyJfc2NoZW1hIiwiU2NyZWVuQ29tcG9uZW50U3lzdGVtIiwiQ29tcG9uZW50U3lzdGVtIiwiY29uc3RydWN0b3IiLCJhcHAiLCJpZCIsIkNvbXBvbmVudFR5cGUiLCJTY3JlZW5Db21wb25lbnQiLCJEYXRhVHlwZSIsIlNjcmVlbkNvbXBvbmVudERhdGEiLCJzY2hlbWEiLCJ3aW5kb3dSZXNvbHV0aW9uIiwiVmVjMiIsIl9kcmF3T3JkZXJTeW5jUXVldWUiLCJJbmRleGVkTGlzdCIsImdyYXBoaWNzRGV2aWNlIiwib24iLCJfb25SZXNpemUiLCJzeXN0ZW1zIiwiX29uVXBkYXRlIiwib25SZW1vdmVDb21wb25lbnQiLCJpbml0aWFsaXplQ29tcG9uZW50RGF0YSIsImNvbXBvbmVudCIsImRhdGEiLCJwcm9wZXJ0aWVzIiwicHJpb3JpdHkiLCJ1bmRlZmluZWQiLCJzY3JlZW5TcGFjZSIsImN1bGwiLCJzY2FsZU1vZGUiLCJzY2FsZUJsZW5kIiwicmVzb2x1dGlvbiIsIl9yZXNvbHV0aW9uIiwiY29weSIsInNldCIsInJlZmVyZW5jZVJlc29sdXRpb24iLCJfcmVmZXJlbmNlUmVzb2x1dGlvbiIsInN5bmNEcmF3T3JkZXIiLCJkZXN0cm95Iiwib2ZmIiwiZHQiLCJjb21wb25lbnRzIiwic3RvcmUiLCJlbnRpdHkiLCJzY3JlZW4iLCJ1cGRhdGUiLCJ3aWR0aCIsImhlaWdodCIsIngiLCJ5IiwiY2xvbmVDb21wb25lbnQiLCJjbG9uZSIsImFkZENvbXBvbmVudCIsImVuYWJsZWQiLCJvblJlbW92ZSIsInByb2Nlc3NEcmF3T3JkZXJTeW5jUXVldWUiLCJsaXN0IiwiaSIsImxlbmd0aCIsIml0ZW0iLCJjYWxsYmFjayIsImNhbGwiLCJzY29wZSIsImNsZWFyIiwicXVldWVEcmF3T3JkZXJTeW5jIiwiZm4iLCJv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
