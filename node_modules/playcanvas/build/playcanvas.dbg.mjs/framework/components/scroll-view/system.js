import { Component } from '../component.js';
import { ComponentSystem } from '../system.js';
import { ScrollViewComponent } from './component.js';
import { ScrollViewComponentData } from './data.js';
import { Vec2 } from '../../../core/math/vec2.js';

const _schema = [{
  name: 'enabled',
  type: 'boolean'
}, {
  name: 'horizontal',
  type: 'boolean'
}, {
  name: 'vertical',
  type: 'boolean'
}, {
  name: 'scrollMode',
  type: 'number'
}, {
  name: 'bounceAmount',
  type: 'number'
}, {
  name: 'friction',
  type: 'number'
}, {
  name: 'dragThreshold',
  type: 'number'
}, {
  name: 'useMouseWheel',
  type: 'boolean'
}, {
  name: 'mouseWheelSensitivity',
  type: 'vec2'
}, {
  name: 'horizontalScrollbarVisibility',
  type: 'number'
}, {
  name: 'verticalScrollbarVisibility',
  type: 'number'
}, {
  name: 'viewportEntity',
  type: 'entity'
}, {
  name: 'contentEntity',
  type: 'entity'
}, {
  name: 'horizontalScrollbarEntity',
  type: 'entity'
}, {
  name: 'verticalScrollbarEntity',
  type: 'entity'
}];
const DEFAULT_DRAG_THRESHOLD = 10;

/**
 * Manages creation of {@link ScrollViewComponent}s.
 *
 * @augments ComponentSystem
 */
class ScrollViewComponentSystem extends ComponentSystem {
  /**
   * Create a new ScrollViewComponentSystem instance.
   *
   * @param {import('../../app-base.js').AppBase} app - The application.
   * @hideconstructor
   */
  constructor(app) {
    super(app);
    this.id = 'scrollview';
    this.ComponentType = ScrollViewComponent;
    this.DataType = ScrollViewComponentData;
    this.schema = _schema;
    this.on('beforeremove', this._onRemoveComponent, this);
    this.app.systems.on('update', this.onUpdate, this);
  }
  initializeComponentData(component, data, properties) {
    if (data.dragThreshold === undefined) {
      data.dragThreshold = DEFAULT_DRAG_THRESHOLD;
    }
    if (data.useMouseWheel === undefined) {
      data.useMouseWheel = true;
    }
    if (data.mouseWheelSensitivity === undefined) {
      data.mouseWheelSensitivity = new Vec2(1, 1);
    }
    super.initializeComponentData(component, data, _schema);
  }
  onUpdate(dt) {
    const components = this.store;
    for (const id in components) {
      const entity = components[id].entity;
      const component = entity.scrollview;
      if (component.enabled && entity.enabled) {
        component.onUpdate();
      }
    }
  }
  _onRemoveComponent(entity, component) {
    component.onRemove();
  }
  destroy() {
    super.destroy();
    this.app.systems.off('update', this.onUpdate, this);
  }
}
Component._buildAccessors(ScrollViewComponent.prototype, _schema);

export { ScrollViewComponentSystem };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3lzdGVtLmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvZnJhbWV3b3JrL2NvbXBvbmVudHMvc2Nyb2xsLXZpZXcvc3lzdGVtLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gJy4uL2NvbXBvbmVudC5qcyc7XG5pbXBvcnQgeyBDb21wb25lbnRTeXN0ZW0gfSBmcm9tICcuLi9zeXN0ZW0uanMnO1xuXG5pbXBvcnQgeyBTY3JvbGxWaWV3Q29tcG9uZW50IH0gZnJvbSAnLi9jb21wb25lbnQuanMnO1xuaW1wb3J0IHsgU2Nyb2xsVmlld0NvbXBvbmVudERhdGEgfSBmcm9tICcuL2RhdGEuanMnO1xuXG5pbXBvcnQgeyBWZWMyIH0gZnJvbSAnLi4vLi4vLi4vY29yZS9tYXRoL3ZlYzIuanMnO1xuXG5jb25zdCBfc2NoZW1hID0gW1xuICAgIHsgbmFtZTogJ2VuYWJsZWQnLCB0eXBlOiAnYm9vbGVhbicgfSxcbiAgICB7IG5hbWU6ICdob3Jpem9udGFsJywgdHlwZTogJ2Jvb2xlYW4nIH0sXG4gICAgeyBuYW1lOiAndmVydGljYWwnLCB0eXBlOiAnYm9vbGVhbicgfSxcbiAgICB7IG5hbWU6ICdzY3JvbGxNb2RlJywgdHlwZTogJ251bWJlcicgfSxcbiAgICB7IG5hbWU6ICdib3VuY2VBbW91bnQnLCB0eXBlOiAnbnVtYmVyJyB9LFxuICAgIHsgbmFtZTogJ2ZyaWN0aW9uJywgdHlwZTogJ251bWJlcicgfSxcbiAgICB7IG5hbWU6ICdkcmFnVGhyZXNob2xkJywgdHlwZTogJ251bWJlcicgfSxcbiAgICB7IG5hbWU6ICd1c2VNb3VzZVdoZWVsJywgdHlwZTogJ2Jvb2xlYW4nIH0sXG4gICAgeyBuYW1lOiAnbW91c2VXaGVlbFNlbnNpdGl2aXR5JywgdHlwZTogJ3ZlYzInIH0sXG4gICAgeyBuYW1lOiAnaG9yaXpvbnRhbFNjcm9sbGJhclZpc2liaWxpdHknLCB0eXBlOiAnbnVtYmVyJyB9LFxuICAgIHsgbmFtZTogJ3ZlcnRpY2FsU2Nyb2xsYmFyVmlzaWJpbGl0eScsIHR5cGU6ICdudW1iZXInIH0sXG4gICAgeyBuYW1lOiAndmlld3BvcnRFbnRpdHknLCB0eXBlOiAnZW50aXR5JyB9LFxuICAgIHsgbmFtZTogJ2NvbnRlbnRFbnRpdHknLCB0eXBlOiAnZW50aXR5JyB9LFxuICAgIHsgbmFtZTogJ2hvcml6b250YWxTY3JvbGxiYXJFbnRpdHknLCB0eXBlOiAnZW50aXR5JyB9LFxuICAgIHsgbmFtZTogJ3ZlcnRpY2FsU2Nyb2xsYmFyRW50aXR5JywgdHlwZTogJ2VudGl0eScgfVxuXTtcblxuY29uc3QgREVGQVVMVF9EUkFHX1RIUkVTSE9MRCA9IDEwO1xuXG4vKipcbiAqIE1hbmFnZXMgY3JlYXRpb24gb2Yge0BsaW5rIFNjcm9sbFZpZXdDb21wb25lbnR9cy5cbiAqXG4gKiBAYXVnbWVudHMgQ29tcG9uZW50U3lzdGVtXG4gKi9cbmNsYXNzIFNjcm9sbFZpZXdDb21wb25lbnRTeXN0ZW0gZXh0ZW5kcyBDb21wb25lbnRTeXN0ZW0ge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIG5ldyBTY3JvbGxWaWV3Q29tcG9uZW50U3lzdGVtIGluc3RhbmNlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtpbXBvcnQoJy4uLy4uL2FwcC1iYXNlLmpzJykuQXBwQmFzZX0gYXBwIC0gVGhlIGFwcGxpY2F0aW9uLlxuICAgICAqIEBoaWRlY29uc3RydWN0b3JcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihhcHApIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcblxuICAgICAgICB0aGlzLmlkID0gJ3Njcm9sbHZpZXcnO1xuXG4gICAgICAgIHRoaXMuQ29tcG9uZW50VHlwZSA9IFNjcm9sbFZpZXdDb21wb25lbnQ7XG4gICAgICAgIHRoaXMuRGF0YVR5cGUgPSBTY3JvbGxWaWV3Q29tcG9uZW50RGF0YTtcblxuICAgICAgICB0aGlzLnNjaGVtYSA9IF9zY2hlbWE7XG5cbiAgICAgICAgdGhpcy5vbignYmVmb3JlcmVtb3ZlJywgdGhpcy5fb25SZW1vdmVDb21wb25lbnQsIHRoaXMpO1xuXG4gICAgICAgIHRoaXMuYXBwLnN5c3RlbXMub24oJ3VwZGF0ZScsIHRoaXMub25VcGRhdGUsIHRoaXMpO1xuICAgIH1cblxuICAgIGluaXRpYWxpemVDb21wb25lbnREYXRhKGNvbXBvbmVudCwgZGF0YSwgcHJvcGVydGllcykge1xuICAgICAgICBpZiAoZGF0YS5kcmFnVGhyZXNob2xkID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGRhdGEuZHJhZ1RocmVzaG9sZCA9IERFRkFVTFRfRFJBR19USFJFU0hPTEQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRhdGEudXNlTW91c2VXaGVlbCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBkYXRhLnVzZU1vdXNlV2hlZWwgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkYXRhLm1vdXNlV2hlZWxTZW5zaXRpdml0eSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBkYXRhLm1vdXNlV2hlZWxTZW5zaXRpdml0eSA9IG5ldyBWZWMyKDEsIDEpO1xuICAgICAgICB9XG5cbiAgICAgICAgc3VwZXIuaW5pdGlhbGl6ZUNvbXBvbmVudERhdGEoY29tcG9uZW50LCBkYXRhLCBfc2NoZW1hKTtcbiAgICB9XG5cbiAgICBvblVwZGF0ZShkdCkge1xuICAgICAgICBjb25zdCBjb21wb25lbnRzID0gdGhpcy5zdG9yZTtcblxuICAgICAgICBmb3IgKGNvbnN0IGlkIGluIGNvbXBvbmVudHMpIHtcbiAgICAgICAgICAgIGNvbnN0IGVudGl0eSA9IGNvbXBvbmVudHNbaWRdLmVudGl0eTtcbiAgICAgICAgICAgIGNvbnN0IGNvbXBvbmVudCA9IGVudGl0eS5zY3JvbGx2aWV3O1xuICAgICAgICAgICAgaWYgKGNvbXBvbmVudC5lbmFibGVkICYmIGVudGl0eS5lbmFibGVkKSB7XG4gICAgICAgICAgICAgICAgY29tcG9uZW50Lm9uVXBkYXRlKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9vblJlbW92ZUNvbXBvbmVudChlbnRpdHksIGNvbXBvbmVudCkge1xuICAgICAgICBjb21wb25lbnQub25SZW1vdmUoKTtcbiAgICB9XG5cbiAgICBkZXN0cm95KCkge1xuICAgICAgICBzdXBlci5kZXN0cm95KCk7XG5cbiAgICAgICAgdGhpcy5hcHAuc3lzdGVtcy5vZmYoJ3VwZGF0ZScsIHRoaXMub25VcGRhdGUsIHRoaXMpO1xuICAgIH1cbn1cblxuQ29tcG9uZW50Ll9idWlsZEFjY2Vzc29ycyhTY3JvbGxWaWV3Q29tcG9uZW50LnByb3RvdHlwZSwgX3NjaGVtYSk7XG5cbmV4cG9ydCB7IFNjcm9sbFZpZXdDb21wb25lbnRTeXN0ZW0gfTtcbiJdLCJuYW1lcyI6WyJfc2NoZW1hIiwibmFtZSIsInR5cGUiLCJERUZBVUxUX0RSQUdfVEhSRVNIT0xEIiwiU2Nyb2xsVmlld0NvbXBvbmVudFN5c3RlbSIsIkNvbXBvbmVudFN5c3RlbSIsImNvbnN0cnVjdG9yIiwiYXBwIiwiaWQiLCJDb21wb25lbnRUeXBlIiwiU2Nyb2xsVmlld0NvbXBvbmVudCIsIkRhdGFUeXBlIiwiU2Nyb2xsVmlld0NvbXBvbmVudERhdGEiLCJzY2hlbWEiLCJvbiIsIl9vblJlbW92ZUNvbXBvbmVudCIsInN5c3RlbXMiLCJvblVwZGF0ZSIsImluaXRpYWxpemVDb21wb25lbnREYXRhIiwiY29tcG9uZW50IiwiZGF0YSIsInByb3BlcnRpZXMiLCJkcmFnVGhyZXNob2xkIiwidW5kZWZpbmVkIiwidXNlTW91c2VXaGVlbCIsIm1vdXNlV2hlZWxTZW5zaXRpdml0eSIsIlZlYzIiLCJkdCIsImNvbXBvbmVudHMiLCJzdG9yZSIsImVudGl0eSIsInNjcm9sbHZpZXciLCJlbmFibGVkIiwib25SZW1vdmUiLCJkZXN0cm95Iiwib2ZmIiwiQ29tcG9uZW50IiwiX2J1aWxkQWNjZXNzb3JzIiwicHJvdG90eXBlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFRQSxNQUFNQSxPQUFPLEdBQUcs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
