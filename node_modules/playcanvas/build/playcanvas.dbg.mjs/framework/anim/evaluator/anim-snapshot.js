import { AnimCache } from './anim-cache.js';

/**
 * AnimSnapshot stores the state of an animation track at a particular time.
 *
 * @ignore
 */
class AnimSnapshot {
  /**
   * Create a new animation snapshot.
   *
   * @param {import('./anim-track.js').AnimTrack} animTrack - The source track.
   */
  constructor(animTrack) {
    this._name = animTrack.name + 'Snapshot';
    this._time = -1;

    // per-curve input cache
    this._cache = [];

    // per-curve evaluation results
    this._results = [];

    // pre-allocate input caches
    for (let i = 0; i < animTrack._inputs.length; ++i) {
      this._cache[i] = new AnimCache();
    }

    // pre-allocate storage for evaluation results
    const curves = animTrack._curves;
    const outputs = animTrack._outputs;
    for (let i = 0; i < curves.length; ++i) {
      const curve = curves[i];
      const output = outputs[curve._output];
      const storage = [];
      for (let j = 0; j < output._components; ++j) {
        storage[j] = 0;
      }
      this._results[i] = storage;
    }
  }
}

export { AnimSnapshot };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYW5pbS1zbmFwc2hvdC5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vc3JjL2ZyYW1ld29yay9hbmltL2V2YWx1YXRvci9hbmltLXNuYXBzaG90LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFuaW1DYWNoZSB9IGZyb20gJy4vYW5pbS1jYWNoZS5qcyc7XG5cbi8qKlxuICogQW5pbVNuYXBzaG90IHN0b3JlcyB0aGUgc3RhdGUgb2YgYW4gYW5pbWF0aW9uIHRyYWNrIGF0IGEgcGFydGljdWxhciB0aW1lLlxuICpcbiAqIEBpZ25vcmVcbiAqL1xuY2xhc3MgQW5pbVNuYXBzaG90IHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSBuZXcgYW5pbWF0aW9uIHNuYXBzaG90LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtpbXBvcnQoJy4vYW5pbS10cmFjay5qcycpLkFuaW1UcmFja30gYW5pbVRyYWNrIC0gVGhlIHNvdXJjZSB0cmFjay5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihhbmltVHJhY2spIHtcbiAgICAgICAgdGhpcy5fbmFtZSA9IGFuaW1UcmFjay5uYW1lICsgJ1NuYXBzaG90JztcbiAgICAgICAgdGhpcy5fdGltZSA9IC0xO1xuXG4gICAgICAgIC8vIHBlci1jdXJ2ZSBpbnB1dCBjYWNoZVxuICAgICAgICB0aGlzLl9jYWNoZSA9IFtdO1xuXG4gICAgICAgIC8vIHBlci1jdXJ2ZSBldmFsdWF0aW9uIHJlc3VsdHNcbiAgICAgICAgdGhpcy5fcmVzdWx0cyA9IFtdO1xuXG4gICAgICAgIC8vIHByZS1hbGxvY2F0ZSBpbnB1dCBjYWNoZXNcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhbmltVHJhY2suX2lucHV0cy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgdGhpcy5fY2FjaGVbaV0gPSBuZXcgQW5pbUNhY2hlKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBwcmUtYWxsb2NhdGUgc3RvcmFnZSBmb3IgZXZhbHVhdGlvbiByZXN1bHRzXG4gICAgICAgIGNvbnN0IGN1cnZlcyA9IGFuaW1UcmFjay5fY3VydmVzO1xuICAgICAgICBjb25zdCBvdXRwdXRzID0gYW5pbVRyYWNrLl9vdXRwdXRzO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGN1cnZlcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgY29uc3QgY3VydmUgPSBjdXJ2ZXNbaV07XG4gICAgICAgICAgICBjb25zdCBvdXRwdXQgPSBvdXRwdXRzW2N1cnZlLl9vdXRwdXRdO1xuICAgICAgICAgICAgY29uc3Qgc3RvcmFnZSA9IFtdO1xuICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBvdXRwdXQuX2NvbXBvbmVudHM7ICsraikge1xuICAgICAgICAgICAgICAgIHN0b3JhZ2Vbal0gPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fcmVzdWx0c1tpXSA9IHN0b3JhZ2U7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmV4cG9ydCB7IEFuaW1TbmFwc2hvdCB9O1xuIl0sIm5hbWVzIjpbIkFuaW1TbmFwc2hvdCIsImNvbnN0cnVjdG9yIiwiYW5pbVRyYWNrIiwiX25hbWUiLCJuYW1lIiwiX3RpbWUiLCJfY2FjaGUiLCJfcmVzdWx0cyIsImkiLCJfaW5wdXRzIiwibGVuZ3RoIiwiQW5pbUNhY2hlIiwiY3VydmVzIiwiX2N1cnZlcyIsIm91dHB1dHMiLCJfb3V0cHV0cyIsImN1cnZlIiwib3V0cHV0IiwiX291dHB1dCIsInN0b3JhZ2UiLCJqIiwiX2NvbXBvbmVudHMiXSwibWFwcGluZ3MiOiI7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU1BLFlBQVksQ0FBQztBQUNmO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7RUFDSUMsV0FBV0EsQ0FBQ0MsU0FBUyxFQUFFO0FBQ25CLElBQUEsSUFBSSxDQUFDQyxLQUFLLEdBQUdELFNBQVMsQ0FBQ0UsSUFBSSxHQUFHLFVBQVUsQ0FBQTtBQUN4QyxJQUFBLElBQUksQ0FBQ0MsS0FBSyxHQUFHLENBQUMsQ0FBQyxDQUFBOztBQUVmO0lBQ0EsSUFBSSxDQUFDQyxNQUFNLEdBQUcsRUFBRSxDQUFBOztBQUVoQjtJQUNBLElBQUksQ0FBQ0MsUUFBUSxHQUFHLEVBQUUsQ0FBQTs7QUFFbEI7QUFDQSxJQUFBLEtBQUssSUFBSUMsQ0FBQyxHQUFHLENBQUMsRUFBRUEsQ0FBQyxHQUFHTixTQUFTLENBQUNPLE9BQU8sQ0FBQ0MsTUFBTSxFQUFFLEVBQUVGLENBQUMsRUFBRTtNQUMvQyxJQUFJLENBQUNGLE1BQU0sQ0FBQ0UsQ0FBQyxDQUFDLEdBQUcsSUFBSUcsU0FBUyxFQUFFLENBQUE7QUFDcEMsS0FBQTs7QUFFQTtBQUNBLElBQUEsTUFBTUMsTUFBTSxHQUFHVixTQUFTLENBQUNXLE9BQU8sQ0FBQTtBQUNoQyxJQUFBLE1BQU1DLE9BQU8sR0FBR1osU0FBUyxDQUFDYSxRQUFRLENBQUE7QUFDbEMsSUFBQSxLQUFLLElBQUlQLENBQUMsR0FBRyxDQUFDLEVBQUVBLENBQUMsR0FBR0ksTUFBTSxDQUFDRixNQUFNLEVBQUUsRUFBRUYsQ0FBQyxFQUFFO0FBQ3BDLE1BQUEsTUFBTVEsS0FBSyxHQUFHSixNQUFNLENBQUNKLENBQUMsQ0FBQyxDQUFBO0FBQ3ZCLE1BQUEsTUFBTVMsTUFBTSxHQUFHSCxPQUFPLENBQUNFLEtBQUssQ0FBQ0UsT0FBTyxDQUFDLENBQUE7TUFDckMsTUFBTUMsT0FBTyxHQUFHLEVBQUUsQ0FBQTtBQUNsQixNQUFBLEtBQUssSUFBSUMsQ0FBQyxHQUFHLENBQUMsRUFBRUEsQ0FBQyxHQUFHSCxNQUFNLENBQUNJLFdBQVcsRUFBRSxFQUFFRCxDQUFDLEVBQUU7QUFDekNELFFBQUFBLE9BQU8sQ0FBQ0MsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFBO0FBQ2xCLE9BQUE7QUFDQSxNQUFBLElBQUksQ0FBQ2IsUUFBUSxDQUFDQyxDQUFDLENBQUMsR0FBR1csT0FBTyxDQUFBO0FBQzlCLEtBQUE7QUFDSixHQUFBO0FBQ0o7Ozs7In0=
